(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();const ke={zh:{title:"È£ü‰πúÂ•Ω",subtitle:"ÂîîÁü•È£üÂí©ÔºüÁ≠âÊàëÂπ´‰Ω†ÊèÄÔºÅ",distanceTitle:"ÊÉ≥ÊêµÂæíÊ≠•ÂπæËÄêÔºü",priceTitle:"ÂÉπÈå¢È†êÁÆóÔºü",filterTitle:"‰ªäÊó•ÂîîÊÉ≥È£üÂí©Ôºü",findBtn:"Âπ´ÊàëÊèÄÔºÅ‚ú®",openMaps:"üó∫Ô∏è Âñ∫ Google Maps ÊâìÈñã",retry:"üé≤ ÂîîÂ§ö‰∏≠ÊÑèÔºüÊäΩÈÅéÈñìÔºÅ",backBtn:"üè† ËøîÂéª‰∏ªÈ†Å",loading:"ÊêúÂ∞ãÁ∑äÈôÑËøëÂ•ΩÂò¢È£ü... üîç",noResults:"ÈôÑËøëÊêµÂîîÂà∞ÈñãÈñÄÂòÖÈ§êÂª≥ÔºåË©¶‰∏ãÊêµÈÅ†Âï≤Ôºü",noFilteredResults:"ÊêµÂîîÂà∞Á¨¶ÂêàÁØ©ÈÅ∏Ê¢ù‰ª∂ÂòÖÈ§êÂª≥ÔºåË©¶‰∏ãË™øÊï¥‰∏ã„Äå‰ªäÊó•ÂîîÊÉ≥È£üÂí©„ÄçÔºüüîç",geoError:"ÊãéÂîîÂà∞‰Ω†ÂÄã‰ΩçÁΩÆÔºåË´ãÊ™¢Êü•‰∏ãÊ¨äÈôê„ÄÇüìç",noGeo:"‰Ω†ÂÄãÁÄèË¶ΩÂô®ÂîîÊîØÊè¥ÂèñÁî®Âú∞ÁêÜ‰ΩçÁΩÆ„ÄÇ",locationTitle:"ÊÉ≥ÊêµÈÇäÈ†≠Ôºü",searchPlaceholder:"üîç ÊêúÂ∞ãÂú∞Èªû",useCurrentLocation:"üìç ‰ΩøÁî®Áï∂Ââç‰ΩçÁΩÆ",installBtn:"ÂÆâË£ù App üì≤",iosInstallText:"ÈªûÊìäÊü•Áúã„ÄåÂÆâË£ù App„ÄçÊïôÂ≠∏ üì≤",iosInstallAlert:`ÊÉ≥Â•Ω‰ºº App ÂíÅÁî®„ÄåÈ£ü‰πúÂ•Ω„ÄçÔºü

1. Êí≥ÁÄèË¶ΩÂô®Â∫ïÈÉ®ÂàÜ‰∫´ÈÅ∏ÂñÆ (Ê≠£ÊñπÂΩ¢Âêë‰∏äÁÆ≠È†≠)
2. Âêë‰∏äÊéÉ‰∏¶ÈªûÈÅ∏„ÄåÂä†ÂÖ•‰∏ªÁï´Èù¢„Äç(Add to Home Screen)

ÊêûÊéÇÔºÅ‚ú®`,categories:{chinese:"üçö ‰∏≠È§ê",japanese:"üç£ Êó•Êú¨Ëèú",korean:"üá∞üá∑ ÈüìÂúãËèú",western:"üçï Ë•øÈ§ê",se_asian:"üç≤ Êù±Âçó‰∫û",noodles:"üçú Á≤âÈ∫µ",spicy:"üå∂Ô∏è Ëæ£Âò¢",hotpot_bbq:"üî• ÁÅ´Èçã/ÁáíÁÉ§",dim_sum:"ü•ü ÈªûÂøÉ/È£≤Ëå∂",dessert:"üçß ÁîúÂìÅ/Á≥ñÊ∞¥",fast_food:"üçî Âø´È§ê/Â∞èÈ£ü",cafe_light:"‚òï ÂíñÂï°/ËºïÈ£ü"},unknownName:"ÂêçÁ®±‰∏çË©≥",noAddress:"Âú∞ÂùÄ‰∏çË©≥",ratingNew:"‚≠ê Êñ∞ÈñãÂºµÔºÅ",priceFree:"ÂÖçË≤ª",walkMins:"Ê≠•Ë°åÁ¥Ñ ${mins} ÂàÜÈêò",shareBtn:"üì§ ÂàÜ‰∫´È§êÂª≥",shareText:"ÊàëÂñ∫„ÄåÈ£ü‰πúÂ•Ω„ÄçÊäΩ‰∏≠ÂíóÂë¢ÈñìÔºö${name}ÔºÅ‰∏ÄÈΩäÂéªË©¶‰∏ãÔºüü•ó",includeClosed:"ÂåÖÂê´Â∑≤ÈóúÈñÄÈ§êÂª≥ üåô",excludeClosed:"Âè™ÈÅ∏ÁáüÊ•≠‰∏≠È§êÂª≥ ‚òÄÔ∏è",reviews:"È£üË©ï"},en:{title:"What to Eat",subtitle:"Don't know? Let me pick!",distanceTitle:"Walking Distance",priceTitle:"Price Range",filterTitle:"What do you NOT want to eat?",findBtn:"Pick for me! ‚ú®",openMaps:"üó∫Ô∏è Open in Google Maps",retry:"üé≤ Not this one? Re-roll!",backBtn:"üè† Back to Home",loading:"Searching for delicious food... üîç",noResults:"No open restaurants found nearby. Try moving a bit?",noFilteredResults:"No restaurants match your filters. Try adjusting them! üîç",geoError:"Unable to find location. Check permissions.",noGeo:"Geolocation not supported by this browser.",locationTitle:"Where to eat?",searchPlaceholder:"üîç Search Location",useCurrentLocation:"üìç Use Current Location",installBtn:"Install App üì≤",iosInstallText:"How to Install App üì≤",iosInstallAlert:`Want to use 'What to Eat' like an App?

1. Tap the Share button in Safari (square with up arrow)
2. Scroll down and tap 'Add to Home Screen'

All set! ‚ú®`,categories:{chinese:"üçö Chinese",japanese:"üç£ Japanese",korean:"üá∞üá∑ Korean",western:"üçï Western",se_asian:"üç≤ SE Asian",noodles:"üçú Noodles",spicy:"üå∂Ô∏è Spicy",hotpot_bbq:"üî• Hotpot/BBQ",dim_sum:"ü•ü Dim Sum",dessert:"üçß Dessert",fast_food:"üçî Fast Food",cafe_light:"‚òï Cafe/Light"},unknownName:"Unknown",noAddress:"Address Unknown",ratingNew:"‚≠ê New!",priceFree:"Free",walkMins:"üö∂ ${mins} min walk",shareBtn:"üì§ Share",shareText:"I picked this on What to Eat: ${name}! Want to try? ü•ó",includeClosed:"Includes Closed Restaurants üåô",excludeClosed:"Open Restaurants Only ‚òÄÔ∏è",reviews:"Reviews"},ja:{title:"„É°„Ç∑Ê±∫",subtitle:"Ëø∑„Å£„Åü„Çâ„ÄÅÁßÅ„Å´ÈÅ∏„Å∞„Åõ„Å¶ÔºÅ",distanceTitle:"ÂæíÊ≠©‰ΩïÂàÜÔºü",priceTitle:"‰∫àÁÆó„ÅØÔºü",filterTitle:"‰ªä„ÅØÈ£ü„Åπ„Åü„Åè„Å™„ÅÑ„ÇÇ„ÅÆ„ÅØÔºü",findBtn:"ÈÅ∏„Çì„ÅßÔºÅ ‚ú®",openMaps:"üó∫Ô∏è Google„Éû„ÉÉ„Éó„ÅßÈñã„Åè",retry:"üé≤ ‰ªñ„ÅÆ„Åå„ÅÑ„ÅÑÔºÅ",backBtn:"üè† „Éõ„Éº„É†„Å´Êàª„Çã",loading:"Ëøë„Åè„ÅÆÁæéÂë≥„Åó„ÅÑÂ∫ó„ÇíÊé¢„Åó„Å¶„ÅÑ„Åæ„Åô... üîç",noResults:"Ëøë„Åè„Å´Âñ∂Ê•≠‰∏≠„ÅÆÂ∫ó„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇ",noFilteredResults:"Êù°‰ª∂„Å´Âêà„ÅÜÂ∫ó„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇ„Éï„Ç£„É´„Çø„Éº„ÇíË™øÊï¥„Åó„Å¶„Åø„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇüîç",geoError:"‰ΩçÁΩÆÊÉÖÂ†±„ÇíÂèñÂæó„Åß„Åç„Åæ„Åõ„Çì„ÄÇË®≠ÂÆö„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",noGeo:"„Åä‰Ωø„ÅÑ„ÅÆ„Éñ„É©„Ç¶„Ç∂„ÅØ‰ΩçÁΩÆÊÉÖÂ†±„Çí„Çµ„Éù„Éº„Éà„Åó„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ",locationTitle:"„Å©„ÅÆËæ∫„ÅßÈ£ü„Åπ„ÇãÔºü",searchPlaceholder:"üîç Â†¥ÊâÄ„ÇíÊ§úÁ¥¢",useCurrentLocation:"üìç ÁèæÂú®Âú∞„Çí‰ΩøÁî®",installBtn:"„Ç¢„Éó„É™„Çí„Ç§„É≥„Çπ„Éà„Éº„É´ üì≤",iosInstallText:"„Ç¢„Éó„É™„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´ÊñπÊ≥ï üì≤",iosInstallAlert:`„Äå‰ΩïÈ£ü„Åπ„ÇãÔºü„Äç„Çí„Ç¢„Éó„É™„ÅÆ„Çà„ÅÜ„Å´‰Ωø„ÅÜÊñπÊ≥ïÔºö

1. Safari „ÅÆÂÖ±Êúâ„Ç¢„Ç§„Ç≥„É≥ÔºàÂõõËßí„Å´‰∏äÁü¢Âç∞Ôºâ„Çí„Çø„ÉÉ„Éó
2. ‰∏ã„Å´„Çπ„ÇØ„É≠„Éº„É´„Åó„Å¶„Äå„Éõ„Éº„É†ÁîªÈù¢„Å´ËøΩÂä†„Äç„Çí„Çø„ÉÉ„Éó

ÂÆå‰∫Ü„Åß„ÅôÔºÅ‚ú®`,categories:{chinese:"üçö ‰∏≠ËèØÊñôÁêÜ",japanese:"üç£ Êó•Êú¨ÊñôÁêÜ",korean:"üá∞üá∑ ÈüìÂõΩÊñôÁêÜ",western:"üçï Ê¥ãÈ£ü",se_asian:"üç≤ Êù±Âçó‰∫û",noodles:"üçú È∫∫È°û",spicy:"üå∂Ô∏è Ëæõ„ÅÑÊñôÁêÜ",hotpot_bbq:"üî• ÁÅ´Èçã/ÁÑºËÇâ",dim_sum:"ü•ü ÁÇπÂøÉ",dessert:"üçß „Éá„Ç∂„Éº„Éà",fast_food:"üçî „Éï„Ç°„Çπ„Éà„Éï„Éº„Éâ",cafe_light:"‚òï „Ç´„Éï„Çß/ËªΩÈ£ü"},unknownName:"‰∏çÊòé",noAddress:"‰ΩèÊâÄ‰∏çÊòé",ratingNew:"‚≠ê Êñ∞Ë¶è„Ç™„Éº„Éó„É≥ÔºÅ",priceFree:"ÁÑ°Êñô",walkMins:"üö∂ ÂæíÊ≠© ${mins} ÂàÜ",shareBtn:"üì§ „Ç∑„Çß„Ç¢",shareText:"„Äå„É°„Ç∑Ê±∫„Äç„Åß„Åì„Çå„ÇíÈÅ∏„Çì„Å†„ÇàÔºö${name}ÔºÅ‰∏ÄÁ∑í„Å´„Å©„ÅÜÔºüü•ó",includeClosed:"Âñ∂Ê•≠ÊôÇÈñìÂ§ñ„ÇÇÂê´„ÇÄ üåô",excludeClosed:"Âñ∂Ê•≠‰∏≠„ÅÆ„Åø ‚òÄÔ∏è",reviews:"Âè£„Ç≥„Éü"}},h=e=>document.getElementById(e);function De(e={}){return new Promise((n,s)=>{if(!navigator.geolocation){s(new Error("GEOLOCATION_NOT_SUPPORTED"));return}navigator.geolocation.getCurrentPosition(n,s,{enableHighAccuracy:!0,timeout:5e3,maximumAge:0,...e})})}const te={chinese:["chinese_restaurant","chinese","cantonese","shanghainese","sichuan","dim sum","congee","‰∏≠Ëèú","‰∏≠Âºè","Á≤µËèú","ÈªûÂøÉ","Á≤•"],japanese:["japanese_restaurant","sushi_restaurant","ramen_restaurant","japanese","sushi","ramen","izakaya","udon","soba","yakitori","tonkatsu","Êó•Êú¨","Â£ΩÂè∏","ÊãâÈ∫µ","Â±ÖÈÖíÂ±ã","ÁÉèÂÜ¨","ÁáíÈ≥•"],korean:["korean_restaurant","korean","kimchi","bibimbap","bbq","ÈüìÂúã","ÈüìÂºè","Ê≥°Ëèú","È£ØÂç∑","ÈüìÁáí"],western:["italian_restaurant","french_restaurant","american_restaurant","hamburger_restaurant","pizza_restaurant","steak_house","steak","italian","french","burger","pasta","pizza","western","mexican","spanish","Ë•øÈ§ê","ÊÑèÂºè","Ê≥ïÂºè","Êº¢Â†°","ËñÑÈ§Ö","ÁâõÊâí"],se_asian:["thai_restaurant","vietnamese_restaurant","thai","vietnamese","malaysian","singaporean","indonesian","Ê≥∞Âúã","Ë∂äÂçó","ÊòüÈ¶¨","Âç∞Â∞º","Ê≥∞Âºè","Ë∂äÂºè"],noodles:["ramen_restaurant","noodle","ramen","udon","pho","Á±≥Á∑ö","ÊãâÈ∫µ","È∫µ","Á≤â","Ê≤≥"],spicy:["spicy","sichuan","mala","chili","Â∑ùËèú","È∫ªËæ£","Ëæ£","Ê∞¥ÁÖÆ","ÈÖ∏Ëæ£"],hotpot_bbq:["barbecue_restaurant","steak_house","hot pot","hotpot","bbq","barbecue","grill","yakiniku","ÁÅ´Èçã","ÈõûÁÖ≤","ÁáíËÇâ","ÈüìÁáí","ÁáíÁÉ§","‰∏≤Ááí"],dim_sum:["chinese_restaurant","dim sum","yum cha","dumpling","ÈªûÂøÉ","È£≤Ëå∂","È§ÉÂ≠ê","ÁõÖÈ£Ø"],dessert:["bakery","ice_cream_shop","dessert","sugar","sweet","bakery","cake","ice cream","Á≥ñÊ∞¥","Áîú","Èõ™Á≥ï","ÂÜ∞","ËõãÁ≥ï","È§Ö"],fast_food:["fast_food_restaurant","hamburger_restaurant","sandwich_shop","fast food","mcdonald","kfc","burger","sandwich","Âø´È§ê","Â∞èÈ£ü","Êº¢Â†°","‰∏âÊñáÊ≤ª"],cafe_light:["cafe","coffee_shop","bakery","cafe","coffee","sandwich","salad","breakfast","brunch","ËºïÈ£ü","ÂíñÂï°","Ê≤ôÂæã","Êó©È§ê","Êó©ÂçàÈ§ê","ÊñáÈùí"]},q=["displayName","location","rating","userRatingCount","formattedAddress","id","types","regularOpeningHours","priceLevel","nationalPhoneNumber","businessStatus","photos","reviews"],ne={PRICE_LEVEL_FREE:{val:"0",label:e=>e.priceFree},PRICE_LEVEL_INEXPENSIVE:{val:"1",label:()=>"$"},PRICE_LEVEL_MODERATE:{val:"2",label:()=>"$$"},PRICE_LEVEL_EXPENSIVE:{val:"3",label:()=>"$$$"},PRICE_LEVEL_VERY_EXPENSIVE:{val:"4",label:()=>"$$$$"}},H={0:"PRICE_LEVEL_FREE",1:"PRICE_LEVEL_INEXPENSIVE",2:"PRICE_LEVEL_MODERATE",3:"PRICE_LEVEL_EXPENSIVE",4:"PRICE_LEVEL_VERY_EXPENSIVE"};function G(e,n){const s=n;return{name:typeof e.displayName=="string"?e.displayName:e.displayName?.text||s.unknownName,rating:e.rating,userRatingCount:e.userRatingCount||0,vicinity:e.formattedAddress||e.vicinity||s.noAddress,place_id:e.id||e.place_id,types:e.types||[],priceLevel:e.priceLevel,phone:e.nationalPhoneNumber,businessStatus:e.businessStatus,location:e.location,openingHours:e.regularOpeningHours,isOpen:null,durationText:null,durationValue:null,durationValue:null,photos:e.photos||[],reviews:e.reviews||[]}}async function ae(e){e.UI.triggerHaptic(50),e.UI.showScreen("loading-screen"),e.Data.history=[];const n=e.translations[e.currentLang];try{let s;e.Data.manualLocation?s={coords:{latitude:e.Data.manualLocation.lat,longitude:e.Data.manualLocation.lng}}:s=await De();const{latitude:o,longitude:i}=s.coords;e.Data.userPos={lat:o,lng:i};const{Place:r}=await google.maps.importLibrary("places"),l=await re(r,e.Data.userPos,e.Config.radius);if(!l||l.length===0){alert(n.noResults),e.UI.showScreen("main-flow");return}const d=await se(l,e.Data.userPos,e);if(d.length===0){alert(n.noFilteredResults),e.UI.showScreen("main-flow");return}e.Data.candidates=d,e.UI.startSlotAnimation(e)}catch(s){console.error("Search Error:",s),Oe(s,n,e)}}async function re(e,n,s){const o={locationRestriction:{center:n,radius:s},includedPrimaryTypes:["restaurant"],fields:q,maxResultCount:20,rankPreference:"POPULARITY"},{places:i}=await e.searchNearby(o);return i}async function se(e,n,s){const o=s.translations[s.currentLang];let r=(await Promise.all(e.map(async c=>{const w=G(c,o);try{w.openingHours?.periods&&(w.isOpen=Re(w.openingHours.periods)),w.isOpen===null&&(w.isOpen=await c.isOpen()),w.isOpen===null&&(w.isOpen=w.openingHours?.openNow)}catch{w.isOpen=null}return w}))).filter(c=>c.businessStatus!=="OPERATIONAL"&&c.businessStatus?!1:s.Config.includeClosed?!0:c.isOpen!==!1);const l=await ie(n,r);let d=l.filter(c=>c.durationValue===null||c.durationValue/60<=s.Config.mins);return d.length===0&&(d=l.sort((c,w)=>(c.durationValue||9999)-(w.durationValue||9999)).slice(0,3)),d.filter(c=>{const w=(c.name||"").toLowerCase(),I=c.types||[];if(Array.from(s.Config.excluded).some(E=>(te[E]||[]).some(D=>w.includes(D)||I.some(B=>B.toLowerCase().includes(D)))))return!1;if(c.priceLevel!==void 0&&c.priceLevel!==null){let E=c.priceLevel;H[E]&&(E=H[E]);const b=ne[E];if(b&&s.Config.prices.size>0&&!s.Config.prices.has(b.val))return!1}return!0})}function Re(e){if(!e||!Array.isArray(e)||e.length===0)return null;if(e.length===1&&!e[0].close)return!0;const n=new Date,s=n.getDay()*1440+n.getHours()*60+n.getMinutes(),o=10080;for(const i of e){if(!i.open||!i.close)continue;const r=Number(i.open.day)*1440+Number(i.open.hour)*60+Number(i.open.minute);let l=Number(i.close.day)*1440+Number(i.close.hour)*60+Number(i.close.minute);if(l<=r&&(l+=o),s>=r&&s<l||s+o>=r&&s+o<l)return!0}return!1}function Oe(e,n,s){e.message==="GEOLOCATION_NOT_SUPPORTED"?alert(n.noGeo):e.code===1?alert(n.geoError):alert("Error: "+e.message),s.UI.showScreen("main-flow")}async function ie(e,n){if(n.length===0)return[];const s=new google.maps.DistanceMatrixService;return new Promise(o=>{s.getDistanceMatrix({origins:[e],destinations:n.map(i=>i.location),travelMode:google.maps.TravelMode.WALKING,unitSystem:google.maps.UnitSystem.METRIC},(i,r)=>{if(r!=="OK"){o(n.map(d=>({...d,durationText:null,durationValue:null})));return}const l=i.rows[0].elements;o(n.map((d,c)=>({...d,durationText:l[c].status==="OK"?l[c].duration.text:null,durationValue:l[c].status==="OK"?l[c].duration.value:null})))})})}async function oe(e){if(e.UI.triggerHaptic([50,30,50]),e.Data.candidates.length===0)return ae(e);let n=e.Data.candidates;if(n.length>1){const i=new Set(e.Data.history||[]),r=n.filter(l=>!i.has(l.place_id));if(r.length>0)n=r;else if(e.Data.lastPickedId){const l=n.filter(d=>d.place_id!==e.Data.lastPickedId);l.length>0&&(n=l)}}let s=n[Math.floor(Math.random()*n.length)];const o=s.openingHours?.weekdayDescriptions?.length>0;if((!s.vicinity||!o)&&s.place_id)try{const{Place:i}=await google.maps.importLibrary("places"),r=new i({id:s.place_id});await r.fetchFields({fields:q}),s=G(r,e.translations[e.currentLang]);const l=e.Data.candidates.findIndex(d=>d.place_id===s.place_id);l!==-1&&(e.Data.candidates[l]=s)}catch(i){console.error("Fetch Details Error:",i)}e.UI.showResult(e,s)}async function Ne(e){const n=e.Data.params.get("resId");if(n){window.history.replaceState({},document.title,window.location.pathname),e.UI.showScreen("loading-screen");try{const{Place:s}=await google.maps.importLibrary("places"),o=new s({id:n});await o.fetchFields({fields:q});const i=e.Data.params.get("lat"),r=e.Data.params.get("lng");i&&r&&(e.Data.userPos={lat:parseFloat(i),lng:parseFloat(r)});const l=e.translations[e.currentLang],d=G(o,l);if(e.Data.userPos&&d.location){const[c]=await ie(e.Data.userPos,[d]);d.durationText=c.durationText,d.durationValue=c.durationValue}if(e.Data.userPos){const c=await re(s,e.Data.userPos,e.Config.radius);c&&c.length>0&&(e.Data.candidates=await se(c,e.Data.userPos,e))}e.UI.showResult(e,d,{fromShare:!0})}catch(s){console.error("Session restoration failed:",s),e.UI.showScreen("main-flow")}}}var K={};(function e(n,s,o,i){var r=!!(n.Worker&&n.Blob&&n.Promise&&n.OffscreenCanvas&&n.OffscreenCanvasRenderingContext2D&&n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype.transferControlToOffscreen&&n.URL&&n.URL.createObjectURL),l=typeof Path2D=="function"&&typeof DOMMatrix=="function",d=(function(){if(!n.OffscreenCanvas)return!1;try{var a=new OffscreenCanvas(1,1),t=a.getContext("2d");t.fillRect(0,0,1,1);var u=a.transferToImageBitmap();t.createPattern(u,"no-repeat")}catch{return!1}return!0})();function c(){}function w(a){var t=s.exports.Promise,u=t!==void 0?t:n.Promise;return typeof u=="function"?new u(a):(a(c,c),null)}var I=(function(a,t){return{transform:function(u){if(a)return u;if(t.has(u))return t.get(u);var g=new OffscreenCanvas(u.width,u.height),m=g.getContext("2d");return m.drawImage(u,0,0),t.set(u,g),g},clear:function(){t.clear()}}})(d,new Map),L=(function(){var a=Math.floor(16.666666666666668),t,u,g={},m=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(t=function(y){var v=Math.random();return g[v]=requestAnimationFrame(function f(p){m===p||m+a-1<p?(m=p,delete g[v],y()):g[v]=requestAnimationFrame(f)}),v},u=function(y){g[y]&&cancelAnimationFrame(g[y])}):(t=function(y){return setTimeout(y,a)},u=function(y){return clearTimeout(y)}),{frame:t,cancel:u}})(),E=(function(){var a,t,u={};function g(m){function y(v,f){m.postMessage({options:v||{},callback:f})}m.init=function(f){var p=f.transferControlToOffscreen();m.postMessage({canvas:p},[p])},m.fire=function(f,p,P){if(t)return y(f,null),t;var T=Math.random().toString(36).slice(2);return t=w(function(M){function x(_){_.data.callback===T&&(delete u[T],m.removeEventListener("message",x),t=null,I.clear(),P(),M())}m.addEventListener("message",x),y(f,T),u[T]=x.bind(null,{data:{callback:T}})}),t},m.reset=function(){m.postMessage({reset:!0});for(var f in u)u[f](),delete u[f]}}return function(){if(a)return a;if(!o&&r){var m=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{a=new Worker(URL.createObjectURL(new Blob([m])))}catch(y){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("üéä Could not load worker",y),null}g(a)}return a}})(),b={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function D(a,t){return t?t(a):a}function B(a){return a!=null}function S(a,t,u){return D(a&&B(a[t])?a[t]:b[t],u)}function le(a){return a<0?0:Math.floor(a)}function ce(a,t){return Math.floor(Math.random()*(t-a))+a}function V(a){return parseInt(a,16)}function de(a){return a.map(ue)}function ue(a){var t=String(a).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:V(t.substring(0,2)),g:V(t.substring(2,4)),b:V(t.substring(4,6))}}function he(a){var t=S(a,"origin",Object);return t.x=S(t,"x",Number),t.y=S(t,"y",Number),t}function fe(a){a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight}function ge(a){var t=a.getBoundingClientRect();a.width=t.width,a.height=t.height}function me(a){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=a,t}function ye(a,t,u,g,m,y,v,f,p){a.save(),a.translate(t,u),a.rotate(y),a.scale(g,m),a.arc(0,0,1,v,f,p),a.restore()}function ve(a){var t=a.angle*(Math.PI/180),u=a.spread*(Math.PI/180);return{x:a.x,y:a.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:a.startVelocity*.5+Math.random()*a.startVelocity,angle2D:-t+(.5*u-Math.random()*u),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:a.color,shape:a.shape,tick:0,totalTicks:a.ticks,decay:a.decay,drift:a.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:a.gravity*3,ovalScalar:.6,scalar:a.scalar,flat:a.flat}}function pe(a,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var u=t.tick++/t.totalTicks,g=t.x+t.random*t.tiltCos,m=t.y+t.random*t.tiltSin,y=t.wobbleX+t.random*t.tiltCos,v=t.wobbleY+t.random*t.tiltSin;if(a.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-u)+")",a.beginPath(),l&&t.shape.type==="path"&&typeof t.shape.path=="string"&&Array.isArray(t.shape.matrix))a.fill(be(t.shape.path,t.shape.matrix,t.x,t.y,Math.abs(y-g)*.1,Math.abs(v-m)*.1,Math.PI/10*t.wobble));else if(t.shape.type==="bitmap"){var f=Math.PI/10*t.wobble,p=Math.abs(y-g)*.1,P=Math.abs(v-m)*.1,T=t.shape.bitmap.width*t.scalar,M=t.shape.bitmap.height*t.scalar,x=new DOMMatrix([Math.cos(f)*p,Math.sin(f)*p,-Math.sin(f)*P,Math.cos(f)*P,t.x,t.y]);x.multiplySelf(new DOMMatrix(t.shape.matrix));var _=a.createPattern(I.transform(t.shape.bitmap),"no-repeat");_.setTransform(x),a.globalAlpha=1-u,a.fillStyle=_,a.fillRect(t.x-T/2,t.y-M/2,T,M),a.globalAlpha=1}else if(t.shape==="circle")a.ellipse?a.ellipse(t.x,t.y,Math.abs(y-g)*t.ovalScalar,Math.abs(v-m)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):ye(a,t.x,t.y,Math.abs(y-g)*t.ovalScalar,Math.abs(v-m)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if(t.shape==="star")for(var C=Math.PI/2*3,k=4*t.scalar,R=8*t.scalar,O=t.x,U=t.y,$=5,N=Math.PI/$;$--;)O=t.x+Math.cos(C)*R,U=t.y+Math.sin(C)*R,a.lineTo(O,U),C+=N,O=t.x+Math.cos(C)*k,U=t.y+Math.sin(C)*k,a.lineTo(O,U),C+=N;else a.moveTo(Math.floor(t.x),Math.floor(t.y)),a.lineTo(Math.floor(t.wobbleX),Math.floor(m)),a.lineTo(Math.floor(y),Math.floor(v)),a.lineTo(Math.floor(g),Math.floor(t.wobbleY));return a.closePath(),a.fill(),t.tick<t.totalTicks}function we(a,t,u,g,m){var y=t.slice(),v=a.getContext("2d"),f,p,P=w(function(T){function M(){f=p=null,v.clearRect(0,0,g.width,g.height),I.clear(),m(),T()}function x(){o&&!(g.width===i.width&&g.height===i.height)&&(g.width=a.width=i.width,g.height=a.height=i.height),!g.width&&!g.height&&(u(a),g.width=a.width,g.height=a.height),v.clearRect(0,0,g.width,g.height),y=y.filter(function(_){return pe(v,_)}),y.length?f=L.frame(x):M()}f=L.frame(x),p=M});return{addFettis:function(T){return y=y.concat(T),P},canvas:a,promise:P,reset:function(){f&&L.cancel(f),p&&p()}}}function J(a,t){var u=!a,g=!!S(t||{},"resize"),m=!1,y=S(t,"disableForReducedMotion",Boolean),v=r&&!!S(t||{},"useWorker"),f=v?E():null,p=u?fe:ge,P=a&&f?!!a.__confetti_initialized:!1,T=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,M;function x(C,k,R){for(var O=S(C,"particleCount",le),U=S(C,"angle",Number),$=S(C,"spread",Number),N=S(C,"startVelocity",Number),Ee=S(C,"decay",Number),Pe=S(C,"gravity",Number),Me=S(C,"drift",Number),X=S(C,"colors",de),Ie=S(C,"ticks",Number),Y=S(C,"shapes"),Se=S(C,"scalar"),Te=!!S(C,"flat"),A=he(C),Q=O,j=[],xe=a.width*A.x,_e=a.height*A.y;Q--;)j.push(ve({x:xe,y:_e,angle:U,spread:$,startVelocity:N,color:X[Q%X.length],shape:Y[ce(0,Y.length)],ticks:Ie,decay:Ee,gravity:Pe,drift:Me,scalar:Se,flat:Te}));return M?M.addFettis(j):(M=we(a,j,p,k,R),M.promise)}function _(C){var k=y||S(C,"disableForReducedMotion",Boolean),R=S(C,"zIndex",Number);if(k&&T)return w(function(N){N()});u&&M?a=M.canvas:u&&!a&&(a=me(R),document.body.appendChild(a)),g&&!P&&p(a);var O={width:a.width,height:a.height};f&&!P&&f.init(a),P=!0,f&&(a.__confetti_initialized=!0);function U(){if(f){var N={getBoundingClientRect:function(){if(!u)return a.getBoundingClientRect()}};p(N),f.postMessage({resize:{width:N.width,height:N.height}});return}O.width=O.height=null}function $(){M=null,g&&(m=!1,n.removeEventListener("resize",U)),u&&a&&(document.body.contains(a)&&document.body.removeChild(a),a=null,P=!1)}return g&&!m&&(m=!0,n.addEventListener("resize",U,!1)),f?f.fire(C,O,$):x(C,O,$)}return _.reset=function(){f&&f.reset(),M&&M.reset()},_}var W;function Z(){return W||(W=J(null,{useWorker:!0,resize:!0})),W}function be(a,t,u,g,m,y,v){var f=new Path2D(a),p=new Path2D;p.addPath(f,new DOMMatrix(t));var P=new Path2D;return P.addPath(p,new DOMMatrix([Math.cos(v)*m,Math.sin(v)*m,-Math.sin(v)*y,Math.cos(v)*y,u,g])),P}function Ce(a){if(!l)throw new Error("path confetti are not supported in this browser");var t,u;typeof a=="string"?t=a:(t=a.path,u=a.matrix);var g=new Path2D(t),m=document.createElement("canvas"),y=m.getContext("2d");if(!u){for(var v=1e3,f=v,p=v,P=0,T=0,M,x,_=0;_<v;_+=2)for(var C=0;C<v;C+=2)y.isPointInPath(g,_,C,"nonzero")&&(f=Math.min(f,_),p=Math.min(p,C),P=Math.max(P,_),T=Math.max(T,C));M=P-f,x=T-p;var k=10,R=Math.min(k/M,k/x);u=[R,0,0,R,-Math.round(M/2+f)*R,-Math.round(x/2+p)*R]}return{type:"path",path:t,matrix:u}}function Le(a){var t,u=1,g="#000000",m='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof a=="string"?t=a:(t=a.text,u="scalar"in a?a.scalar:u,m="fontFamily"in a?a.fontFamily:m,g="color"in a?a.color:g);var y=10*u,v=""+y+"px "+m,f=new OffscreenCanvas(y,y),p=f.getContext("2d");p.font=v;var P=p.measureText(t),T=Math.ceil(P.actualBoundingBoxRight+P.actualBoundingBoxLeft),M=Math.ceil(P.actualBoundingBoxAscent+P.actualBoundingBoxDescent),x=2,_=P.actualBoundingBoxLeft+x,C=P.actualBoundingBoxAscent+x;T+=x+x,M+=x+x,f=new OffscreenCanvas(T,M),p=f.getContext("2d"),p.font=v,p.fillStyle=g,p.fillText(t,_,C);var k=1/u;return{type:"bitmap",bitmap:f.transferToImageBitmap(),matrix:[k,0,0,k,-T*k/2,-M*k/2]}}s.exports=function(){return Z().apply(this,arguments)},s.exports.reset=function(){Z().reset()},s.exports.create=J,s.exports.shapeFromPath=Ce,s.exports.shapeFromText=Le})((function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}})(),K,!1);const z=K.exports;K.exports.create;const Fe={showScreen(e){["main-flow","result-screen","loading-screen"].forEach(r=>{const l=h(r);l&&l.classList.toggle("hidden",r!==e)});const s=h("footer-home"),o=h("footer-result"),i=h("app-footer");e==="main-flow"?(i&&i.classList.remove("hidden"),s&&s.classList.remove("hidden"),o&&o.classList.add("hidden")):e==="result-screen"?(i&&i.classList.remove("hidden"),s&&s.classList.add("hidden"),o&&o.classList.remove("hidden")):i&&i.classList.add("hidden")},updateStrings(e){const n=e.translations[e.currentLang],s={"location-title":n.locationTitle,"app-title":n.title,"app-subtitle":n.subtitle,"price-title":n.priceTitle,"filter-title":n.filterTitle,"find-btn":n.findBtn,"retry-btn":n.retry,"back-btn":n.backBtn,"loading-text":n.loading,"open-maps-btn":n.openMaps,"share-btn":n.shareBtn,"install-btn":n.installBtn,"reviews-title":n.reviews};Object.entries(s).forEach(([d,c])=>{const w=h(d);w&&(w.textContent=c)});const o=h("location-input");o&&(o.placeholder=n.searchPlaceholder);const i=h("location-display");i&&!e.Data.manualLocation&&(i.textContent=n.useCurrentLocation);const r=h("distance-title");r&&(r.innerHTML=`${n.distanceTitle} (<span id="distance-val">${e.Config.mins}</span> mins)`);const l=h("include-closed-btn");if(l){const d=e.Config.includeClosed;l.classList.toggle("active",d);const c=h("include-closed-label");c&&(c.textContent=d?n.includeClosed:n.excludeClosed)}document.querySelectorAll(".lang-selector span").forEach(d=>{d.classList.toggle("active",d.dataset.lang===e.currentLang)})},initFilters(e){const n=h("filter-list");if(!n)return;n.innerHTML="";const s=e.translations[e.currentLang].categories;Object.keys(s).forEach(o=>{const i=document.createElement("div");i.className=`filter-item ${e.Config.excluded.has(o)?"active":""}`,i.textContent=s[o],i.onclick=()=>{i.classList.toggle("active")?e.Config.excluded.add(o):e.Config.excluded.delete(o),e.saveSettings(),this.triggerHaptic(30)},n.appendChild(i)}),document.querySelectorAll(".price-item").forEach(o=>{const i=o.dataset.price;o.classList.toggle("active",e.Config.prices.has(i)),o.onclick=()=>{o.classList.toggle("active")?e.Config.prices.add(i):e.Config.prices.delete(i),e.saveSettings(),this.triggerHaptic(30)}})},async showResult(e,n,s={}){const{fromShare:o=!1}=s;this.showScreen("result-screen"),e.Data.lastPickedId=n.place_id,e.Data.history||(e.Data.history=[]),e.Data.history.includes(n.place_id)||e.Data.history.push(n.place_id),e.Data.currentPlace=n;const i=e.translations[e.currentLang],r={name:h("res-name"),rating:h("res-rating"),ratingCont:h("res-rating-container"),price:h("res-price"),priceCont:h("res-price-container"),cat:h("res-category"),catIcon:h("res-category-icon"),catCont:h("res-category-container"),hours:h("res-hours"),hoursCont:h("res-hours-container"),address:h("res-address"),mapCont:h("res-map-container"),phone:h("res-phone"),distance:h("res-distance"),distanceCont:h("res-distance-container"),mapsBtn:h("open-maps-btn"),photoCont:h("res-photo-container")};if(r.name&&(r.name.textContent=n.name),r.address&&(r.address.textContent=n.vicinity),!o){const E=h("result-screen");E&&E.scrollIntoView({behavior:"smooth",block:"start"})}r.photoCont&&(r.photoCont.innerHTML="",n.photos&&n.photos.length>0?(r.photoCont.classList.remove("hidden"),n.photos.forEach(E=>{const b=document.createElement("img");b.src=E.getURI({maxHeight:400}),b.className="photo-item",b.alt=n.name,b.loading="lazy",r.photoCont.appendChild(b)})):r.photoCont.classList.add("hidden"));const l=h("res-reviews-container"),d=h("reviews-list");if(l&&d)if(n.reviews&&n.reviews.length>0){l.classList.remove("hidden"),d.innerHTML="",d.scrollLeft=0;const E=n.reviews.filter(b=>b.text&&(b.text.text||b.text).length>0).sort((b,D)=>{const B=b.publishTime?new Date(b.publishTime).getTime():0;return(D.publishTime?new Date(D.publishTime).getTime():0)-B});E.length===0?l.classList.add("hidden"):E.forEach(b=>{const D=document.createElement("div");D.className="review-item";const B="‚≠ê".repeat(Math.round(b.rating||0)),S=b.relativePublishTimeDescription||"";D.innerHTML=`
                            <div class="review-top">
                                <span class="review-author">${b.authorAttribution?.displayName||"Anonymous"}</span>
                                <span class="review-time">${S}</span>
                            </div>
                            <div class="review-stars">${B}</div>
                            <p class="review-text">${b.text?.text||b.text||""}</p>
                        `,d.appendChild(D)})}else l.classList.add("hidden");const c=typeof n.rating=="number"&&n.rating>0;r.rating&&(r.rating.textContent=c?n.rating:i.ratingNew.replace(/‚≠ê\s*/,""));const w=this.getPriceDisplay(n.priceLevel,i);r.price&&(r.price.textContent=w),r.priceCont&&(r.priceCont.style.display=w?"flex":"none");const I=this.getPlaceCategory(n,e);if(I){const E=I.match(new RegExp("^(\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F)\\s*(.*)$","u"));r.catIcon&&(r.catIcon.textContent=E?E[1]:"üç¥"),r.cat&&(r.cat.textContent=E?E[2]:I),r.catCont&&(r.catCont.style.display="flex")}else r.catCont&&(r.catCont.style.display="none");const L=this.getTodayHours(n,e);r.hours&&(r.hours.textContent=L),r.hoursCont&&(r.hoursCont.style.display=L?"flex":"none"),n.durationText?(r.distance&&(r.distance.textContent=n.durationText),r.distanceCont&&(r.distanceCont.style.display="flex")):r.distanceCont&&(r.distanceCont.style.display="none"),n.phone?r.phone&&(r.phone.textContent=`üìû ${n.phone}`,r.phone.href=`tel:${n.phone.replace(/\s+/g,"")}`,r.phone.style.display=""):r.phone&&(r.phone.style.display="none"),r.mapsBtn&&(r.mapsBtn.href=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(n.name)}&query_place_id=${n.place_id}`),this.renderMap(r.mapCont,n,e),o||this.triggerConfetti()},async renderMap(e,n,s){if(e){if(!n.location){e.style.display="none";return}e.classList.add("skeleton"),e.style.display="block";try{const[{Map:o},{AdvancedMarkerElement:i}]=await Promise.all([google.maps.importLibrary("maps"),google.maps.importLibrary("marker")]),r=new o(e,{center:n.location,zoom:16,mapId:"DEMO_MAP_ID",disableDefaultUI:!1,mapTypeControl:!1,streetViewControl:!1,gestureHandling:"greedy",colorScheme:"FOLLOW_SYSTEM"});if(new i({map:r,position:n.location,title:n.name}),s.Data.userPos){const l=document.createElement("div");l.style.width="16px",l.style.height="16px",l.style.backgroundColor="#4285F4",l.style.border="2px solid white",l.style.borderRadius="50%",l.style.boxShadow="0 0 4px rgba(0,0,0,0.3)",new i({map:r,position:s.Data.userPos,title:"Your Location",content:l});const d=new google.maps.LatLngBounds;d.extend(n.location),d.extend(s.Data.userPos),r.fitBounds(d,50)}google.maps.event.addListenerOnce(r,"idle",()=>e.classList.remove("skeleton"))}catch(o){console.error("Map Render Error:",o),e.style.display="none"}}},startSlotAnimation(e){const n=h("slot-name");if(!n)return;let s=0;const o=setInterval(()=>{const i=e.Data.candidates[Math.floor(Math.random()*e.Data.candidates.length)];n.textContent=i?.name||"...",++s>15&&(clearInterval(o),oe(e))},100)},getPlaceCategory(e,n){const s=n.translations[n.currentLang].categories,o=(e.name||"").toLowerCase(),i=e.types||[];for(const[r,l]of Object.entries(te))if(l.some(d=>o.includes(d)||i.some(c=>c.toLowerCase().includes(d))))return s[r];return null},getPriceDisplay(e,n){if(e==null)return"";let s=e;H[s]&&(s=H[s]);const o=ne[s];return o?o.label(n):""},getTodayHours(e,n){const s=e.openingHours?.weekdayDescriptions;if(!s||s.length!==7)return"";const o=new Date,r={zh:"zh-HK",en:"en-US",ja:"ja-JP"}[n.currentLang]||"zh-HK",l=o.toLocaleDateString(r,{weekday:"long"}),d=o.toLocaleDateString("en-US",{weekday:"long"});let c=s.find(w=>w.includes(l)||w.includes(d));if(c||(c=s[o.getDay()]),c){const w=c.split(/: |Ôºö/);return w[1]?w[1].trim():c}return""},triggerHaptic(e){navigator.vibrate&&navigator.vibrate(e||30)},triggerConfetti(){(z.create?z.create():z)({particleCount:150,spread:70,origin:{y:.6},colors:["#ff6b81","#ffd32a","#2ecc71","#3498db"]})},async shareCurrentPlace(e){const n=e.Data.currentPlace;if(!n)return;const s=e.translations[e.currentLang],o=`${window.location.origin}${window.location.pathname}?resId=${n.place_id}${e.Data.userPos?`&lat=${e.Data.userPos.lat}&lng=${e.Data.userPos.lng}`:""}`,i=s.shareText.replace("${name}",n.name);if(navigator.share)try{await navigator.share({title:n.name,text:i,url:o})}catch(r){console.log("Share failed",r)}else try{await navigator.clipboard.writeText(`${i}
${o}`);const r=e.currentLang==="zh"?"Â∑≤Ë§áË£ΩÈÄ£ÁµêÂà∞Ââ™Ë≤ºÁ∞øÔºÅüìã":e.currentLang==="ja"?"„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅüìã":"Link copied to clipboard! üìã";alert(r)}catch{alert(o)}}},Be="modulepreload",Ue=function(e){return"/"+e},ee={},$e=function(n,s,o){let i=Promise.resolve();if(s&&s.length>0){let w=function(I){return Promise.all(I.map(L=>Promise.resolve(L).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};var l=w;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),c=d?.nonce||d?.getAttribute("nonce");i=w(s.map(I=>{if(I=Ue(I),I in ee)return;ee[I]=!0;const L=I.endsWith(".css"),E=L?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${I}"]${E}`))return;const b=document.createElement("link");if(b.rel=L?"stylesheet":Be,L||(b.as="script"),b.crossOrigin="",b.href=I,c&&b.setAttribute("nonce",c),document.head.appendChild(b),L)return new Promise((D,B)=>{b.addEventListener("load",D),b.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${I}`)))})}))}function r(d){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=d,window.dispatchEvent(c),!c.defaultPrevented)throw d}return i.then(d=>{for(const c of d||[])c.status==="rejected"&&r(c.reason);return n().catch(r)})};function He(e={}){const{immediate:n=!1,onNeedRefresh:s,onOfflineReady:o,onRegistered:i,onRegisteredSW:r,onRegisterError:l}=e;let d,c;const w=async(L=!0)=>{await c};async function I(){if("serviceWorker"in navigator){if(d=await $e(async()=>{const{Workbox:L}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:L}},[]).then(({Workbox:L})=>new L("/sw.js",{scope:"/",type:"classic"})).catch(L=>{l?.(L)}),!d)return;d.addEventListener("activated",L=>{(L.isUpdate||L.isExternal)&&window.location.reload()}),d.addEventListener("installed",L=>{L.isUpdate||o?.()}),d.register({immediate:n}).then(L=>{r?r("/sw.js",L):i?.(L)}).catch(L=>{l?.(L)})}}return c=I(),w}const Ve={deferredPrompt:null,init(e,n){"serviceWorker"in navigator&&He({immediate:!0,onNeedRefresh(){console.log("New content available, reloading..."),window.location.reload()},onOfflineReady(){console.log("App ready to work offline")}}),window.addEventListener("beforeinstallprompt",o=>{o.preventDefault(),this.deferredPrompt=o,h("install-container")&&!this.isIOS()&&h("install-container").classList.remove("hidden")}),window.addEventListener("appinstalled",()=>{this.deferredPrompt=null,h("install-container")&&h("install-container").classList.add("hidden")});const s=h("install-btn");s&&(s.addEventListener("click",()=>this.handleInstall()),this.isIOS()&&!this.isStandalone()&&(h("install-container").classList.remove("hidden"),s.innerHTML=`<span>${e[n].iosInstallText}</span>`,s.classList.add("ios-guide")))},isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},isStandalone(){return window.navigator.standalone||window.matchMedia("(display-mode: standalone)").matches},async handleInstall(){if(this.isIOS()){alert(window.App.translations[window.App.currentLang].iosInstallAlert);return}if(!this.deferredPrompt)return;this.deferredPrompt.prompt();const{outcome:e}=await this.deferredPrompt.userChoice;this.deferredPrompt=null,h("install-container")&&h("install-container").classList.add("hidden")}},F={Config:{mins:parseInt(localStorage.getItem("currentMins")||"5"),includeClosed:localStorage.getItem("includeClosed")==="true",get radius(){return this.mins*80},excluded:new Set(JSON.parse(localStorage.getItem("excludedTypes")||"[]")),prices:new Set(JSON.parse(localStorage.getItem("selectedPrices")||'["1","2","3","4"]')),lang:(function(){let n=new URLSearchParams(window.location.search).get("lang")||localStorage.getItem("preferredLang");if(n&&(n.startsWith("zh")&&(n="zh"),n.startsWith("ja")&&(n="ja"),["zh","en","ja"].includes(n)))return n;const s=navigator.language||navigator.userLanguage;return s.startsWith("ja")?"ja":s.startsWith("zh")?"zh":"en"})()},Data:{userPos:null,manualLocation:null,candidates:[],currentPlace:null,lastPickedId:null,history:[],params:new URLSearchParams(window.location.search)},UI:Fe,PWA:Ve,translations:ke,get currentLang(){return this.Config.lang},saveSettings(){localStorage.setItem("currentMins",this.Config.mins.toString()),localStorage.setItem("includeClosed",this.Config.includeClosed),localStorage.setItem("selectedPrices",JSON.stringify(Array.from(this.Config.prices))),localStorage.setItem("excludedTypes",JSON.stringify(Array.from(this.Config.excluded)))},setLanguage(e){if(this.currentLang===e)return;localStorage.setItem("preferredLang",e),this.saveSettings();let n=window.location.pathname+"?lang="+e;!h("result-screen").classList.contains("hidden")&&this.Data.lastPickedId&&(n+="&resId="+this.Data.lastPickedId,this.Data.userPos&&(n+=`&lat=${this.Data.userPos.lat}&lng=${this.Data.userPos.lng}`)),window.location.href=n},init(){this.UI.updateStrings(this),this.UI.initFilters(this),this.setupEventListeners(),this.PWA.init(this.translations,this.currentLang),Ne(this),this.initLocationSearch()},async initLocationSearch(){const e=h("location-input"),n=h("location-bar"),s=h("location-display"),o=h("clear-location");if(!e||!n||!s||!o)return;const i=this.translations[this.currentLang];s.textContent=i.useCurrentLocation,n.onclick=l=>{l.target.closest(".clear-icon")||(n.classList.add("hidden"),e.classList.remove("hidden"),e.focus())};const r=()=>{setTimeout(()=>{e.classList.add("hidden"),n.classList.remove("hidden")},200)};e.onblur=r,o.onclick=l=>{l.stopPropagation(),this.Data.manualLocation=null,e.value="",s.textContent=i.useCurrentLocation,o.classList.add("hidden"),this.UI.triggerHaptic(30)};try{const{Autocomplete:l}=await google.maps.importLibrary("places"),d=new l(e,{fields:["geometry","name"],types:["geocode","establishment"]});d.addListener("place_changed",()=>{const c=d.getPlace();!c.geometry||!c.geometry.location||(this.Data.manualLocation={lat:c.geometry.location.lat(),lng:c.geometry.location.lng(),name:c.name},s.textContent="üìç "+c.name,o.classList.remove("hidden"),e.value=c.name,r(),this.UI.triggerHaptic(50))})}catch(l){console.error("Autocomplete init failed:",l)}},setupEventListeners(){const e=h("find-btn");e&&(e.onclick=()=>ae(this));const n=h("retry-btn");n&&(n.onclick=()=>oe(this));const s=h("share-btn");s&&(s.onclick=()=>this.UI.shareCurrentPlace(this));const o=h("back-btn");o&&(o.onclick=()=>this.UI.showScreen("main-flow")),document.querySelectorAll(".lang-selector span").forEach(l=>{l.onclick=()=>this.setLanguage(l.dataset.lang)});const i=h("distance-slider");i&&(i.value=this.Config.mins,i.oninput=function(){const l=parseInt(this.value);F.Config.mins=l,h("distance-val").textContent=l,F.saveSettings(),F.UI.triggerHaptic(10)});const r=h("include-closed-btn");r&&(r.onclick=()=>{F.Config.includeClosed=!F.Config.includeClosed,F.saveSettings(),F.UI.updateStrings(F),F.UI.triggerHaptic(30)})}};document.addEventListener("DOMContentLoaded",()=>{F.init()});
