(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();const Ue={zh:{title:"é£Ÿä¹œå¥½",subtitle:"å””çŸ¥é£Ÿå’©ï¼Ÿç­‰æˆ‘å¹«ä½ æ€ï¼",distanceTitle:"æƒ³æµå¾’æ­¥å¹¾è€ï¼Ÿ",priceTitle:"åƒ¹éŒ¢é ç®—ï¼Ÿ",filterTitle:"è€Œå®¶æƒ³é£Ÿå’©ï¼Ÿ",filterModeWhitelist:"è€Œå®¶æƒ³é£Ÿå’©ï¼ŸðŸ˜‹",filterModeBlacklist:"è€Œå®¶å””æƒ³é£Ÿå’©ï¼ŸðŸ™…â€â™‚ï¸",filterToggleWhitelist:"åˆ‡æ›åˆ°ï¼šæƒ³é£Ÿæ¨¡å¼",filterToggleBlacklist:"åˆ‡æ›åˆ°ï¼šå””æƒ³é£Ÿæ¨¡å¼",findBtn:"å¹«æˆ‘æ€ï¼âœ¨",openMaps:"ðŸ—ºï¸ å–º Google Maps æ‰“é–‹",retry:"ðŸŽ² å””å¤šä¸­æ„ï¼ŸæŠ½éŽé–“ï¼",backBtn:"ðŸ  è¿”åŽ»ä¸»é ",loading:"æœå°‹ç·Šé™„è¿‘å¥½å˜¢é£Ÿ... ðŸ”",noResults:"é™„è¿‘æµå””åˆ°é–‹é–€å˜…é¤å»³ï¼Œè©¦ä¸‹æµé å•²ï¼Ÿ",noFilteredResultsWhitelist:"æµå””åˆ°ç¬¦åˆæ¢ä»¶å˜…é¤å»³ï¼Œè©¦ä¸‹æ€å¤šå¹¾å€‹ã€Œè€Œå®¶æƒ³é£Ÿå’©ã€ï¼ŸðŸ”",noFilteredResultsBlacklist:"æµå””åˆ°ç¬¦åˆæ¢ä»¶å˜…é¤å»³ï¼Œè©¦ä¸‹èª¿æ•´ä¸‹ã€Œè€Œå®¶å””æƒ³é£Ÿå’©ã€ï¼ŸðŸ”",noFilteredResults:"æµå””åˆ°ç¬¦åˆç¯©é¸æ¢ä»¶å˜…é¤å»³ï¼Œè©¦ä¸‹èª¿æ•´ä¸‹ç¯©é¸å™¨ï¼ŸðŸ”",geoError:"æ‹Žå””åˆ°ä½ å€‹ä½ç½®ï¼Œè«‹æª¢æŸ¥ä¸‹æ¬Šé™ã€‚ðŸ“",noGeo:"ä½ å€‹ç€è¦½å™¨å””æ”¯æ´å–ç”¨åœ°ç†ä½ç½®ã€‚",locationTitle:"æƒ³æµé‚Šé ­ï¼Ÿ",searchPlaceholder:"ðŸ” æœå°‹åœ°é»ž",useCurrentLocation:"ðŸ“ ä½¿ç”¨ç•¶å‰ä½ç½®",installBtn:"å®‰è£ App ðŸ“²",iosInstallText:"é»žæ“ŠæŸ¥çœ‹ã€Œå®‰è£ Appã€æ•™å­¸ ðŸ“²",iosInstallAlert:`æƒ³å¥½ä¼¼ App å’ç”¨ã€Œé£Ÿä¹œå¥½ã€ï¼Ÿ

1. æ’³ç€è¦½å™¨åº•éƒ¨åˆ†äº«é¸å–® (æ­£æ–¹å½¢å‘ä¸Šç®­é ­)
2. å‘ä¸ŠæŽƒä¸¦é»žé¸ã€ŒåŠ å…¥ä¸»ç•«é¢ã€(Add to Home Screen)

æžæŽ‚ï¼âœ¨`,linkCopied:"å·²è¤‡è£½é€£çµåˆ°å‰ªè²¼ç°¿ï¼ðŸ“‹",categories:{chinese:"ðŸš ä¸­é¤",japanese:"ðŸ£ æ—¥æœ¬èœ",korean:"ðŸ‡°ðŸ‡· éŸ“åœ‹èœ",western:"ðŸ• è¥¿é¤",se_asian:"ðŸ² æ±å—äºž",indian_middle_east:"ðŸ•Œ å°åº¦/ä¸­æ±",noodles:"ðŸœ ç²‰éºµ",rice_bento:"ðŸ± é£¯/å®šé£Ÿ/ä¾¿ç•¶",sushi_sashimi:"ðŸ£ å£½å¸/åˆºèº«",burger_pizza:"ðŸ• æ¼¢å ¡/è–„é¤…",hotpot_bbq:"ðŸ”¥ ç«é‹/ç‡’çƒ¤",dim_sum:"ðŸ¥Ÿ é»žå¿ƒ/é£²èŒ¶",fine_dining_buffet:"ðŸ¥‚ é«˜æª”/è‡ªåŠ©é¤",all_day_brunch:"ðŸ³ All-day Brunch",bar_izakaya:"ðŸ¹ é…’å§/å±…é…’å±‹",spicy:"ðŸŒ¶ï¸ è¾£å˜¢",dessert:"ðŸ§ ç”œå“/ç³–æ°´",fast_food:"ðŸ” å¿«é¤/å°é£Ÿ",healthy_vege:"ðŸ¥¦ ç´ é£Ÿ/å¥åº·"},unknownName:"åç¨±ä¸è©³",noAddress:"åœ°å€ä¸è©³",ratingNew:"â­ æ–°é–‹å¼µï¼",noHoursInfo:"æœªèƒ½æä¾›ç‡Ÿæ¥­æ™‚é–“",priceFree:"å…è²»",walkMins:"æ­¥è¡Œç´„ ${mins} åˆ†é˜",shareBtn:"ðŸ“¤ åˆ†äº«é¤å»³",shareText:"æˆ‘å–ºã€Œé£Ÿä¹œå¥½ã€æŠ½ä¸­å’—å‘¢é–“ï¼š${name}ï¼ä¸€é½ŠåŽ»è©¦ä¸‹ï¼ŸðŸ¥—",includeClosed:"åŒ…å«å·²é—œé–€é¤å»³ ðŸŒ™",excludeClosed:"åªé¸ç‡Ÿæ¥­ä¸­é¤å»³ â˜€ï¸",reviews:"é£Ÿè©•",viewAllReviews:"æŸ¥çœ‹å…¨éƒ¨",photosTitle:"ç›¸ç‰‡",viewAllPhotos:"æŸ¥çœ‹å…¨éƒ¨"},en:{title:"What to Eat",subtitle:"Don't know? Let me pick!",distanceTitle:"Walking Distance",priceTitle:"Price Range",filterTitle:"What do you want to eat?",filterModeWhitelist:"What do you want? ðŸ˜‹",filterModeBlacklist:"What do you NOT want? ðŸ™…â€â™‚ï¸",filterToggleWhitelist:"Switch to: Want",filterToggleBlacklist:"Switch to: Don't Want",findBtn:"Pick for me! âœ¨",openMaps:"ðŸ—ºï¸ Open in Google Maps",retry:"ðŸŽ² Not this one? Re-roll!",backBtn:"ðŸ  Back to Home",loading:"Searching for delicious food... ðŸ”",noResults:"No open restaurants found nearby. Try moving a bit?",noFilteredResultsWhitelist:"No restaurants match your filters. Try picking more items in 'What do you want'? ðŸ”",noFilteredResultsBlacklist:"No restaurants match your filters. Try adjusting 'What do you NOT want'? ðŸ”",noFilteredResults:"No restaurants match your filters. Try adjusting them! ðŸ”",geoError:"Unable to find location. Check permissions.",noGeo:"Geolocation not supported by this browser.",locationTitle:"Where to eat?",searchPlaceholder:"ðŸ” Search Location",useCurrentLocation:"ðŸ“ Use Current Location",installBtn:"Install App ðŸ“²",iosInstallText:"How to Install App ðŸ“²",iosInstallAlert:`Want to use 'What to Eat' like an App?

1. Tap the Share button in Safari (square with up arrow)
2. Scroll down and tap 'Add to Home Screen'

All set! âœ¨`,linkCopied:"Link copied to clipboard! ðŸ“‹",categories:{chinese:"ðŸš Chinese",japanese:"ðŸ£ Japanese",korean:"ðŸ‡°ðŸ‡· Korean",western:"ðŸ• Western",se_asian:"ðŸ² SE Asian",indian_middle_east:"ðŸ•Œ Indian/Middle East",noodles:"ðŸœ Noodles",rice_bento:"ðŸ± Rice/Bento",sushi_sashimi:"ðŸ£ Sushi/Sashimi",burger_pizza:"ðŸ• Burger/Pizza",hotpot_bbq:"ðŸ”¥ Hotpot/BBQ",dim_sum:"ðŸ¥Ÿ Dim Sum",fine_dining_buffet:"ðŸ¥‚ Fine Dining/Buffet",all_day_brunch:"ðŸ³ All-day Brunch",bar_izakaya:"ðŸ¹ Bar/Izakaya",spicy:"ðŸŒ¶ï¸ Spicy",dessert:"ðŸ§ Dessert",fast_food:"ðŸ” Fast Food",healthy_vege:"ðŸ¥¦ Healthy/Vege"},unknownName:"Unknown",noAddress:"Address Unknown",ratingNew:"â­ New!",noHoursInfo:"No opening hours info",priceFree:"Free",walkMins:"ðŸš¶ ${mins} min walk",shareBtn:"ðŸ“¤ Share",shareText:"I picked this on What to Eat: ${name}! Want to try? ðŸ¥—",includeClosed:"Includes Closed Restaurants ðŸŒ™",excludeClosed:"Open Restaurants Only â˜€ï¸",reviews:"Reviews",viewAllReviews:"View All",photosTitle:"Photos",viewAllPhotos:"View All"},ja:{title:"ãƒ¡ã‚·æ±º",subtitle:"è¿·ã£ãŸã‚‰ã€ç§ã«é¸ã°ã›ã¦ï¼",distanceTitle:"å¾’æ­©ä½•åˆ†ï¼Ÿ",priceTitle:"äºˆç®—ã¯ï¼Ÿ",filterTitle:"ä½•ãŒé£Ÿã¹ãŸã„ï¼Ÿ",filterModeWhitelist:"ä½•ãŒé£Ÿã¹ãŸã„ï¼Ÿ ðŸ˜‹",filterModeBlacklist:"é£Ÿã¹ãŸããªã„ã‚‚ã®ã¯ï¼Ÿ ðŸ™…â€â™‚ï¸",filterToggleWhitelist:"é£Ÿã¹ãŸã„ãƒ¢ãƒ¼ãƒ‰ã¸",filterToggleBlacklist:"é£Ÿã¹ãŸããªã„ãƒ¢ãƒ¼ãƒ‰ã¸",findBtn:"é¸ã‚“ã§ï¼ âœ¨",openMaps:"ðŸ—ºï¸ Googleãƒžãƒƒãƒ—ã§é–‹ã",retry:"ðŸŽ² ä»–ã®ãŒã„ã„ï¼",backBtn:"ðŸ  ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹",loading:"è¿‘ãã®ç¾Žå‘³ã—ã„åº—ã‚’æŽ¢ã—ã¦ã„ã¾ã™... ðŸ”",noResults:"è¿‘ãã«å–¶æ¥­ä¸­ã®åº—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚",noFilteredResultsWhitelist:"æ¡ä»¶ã«åˆã†åº—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ã€Œä½•ãŒé£Ÿã¹ãŸã„ã€ã‚’èª¿æ•´ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ðŸ”",noFilteredResultsBlacklist:"æ¡ä»¶ã«åˆã†åº—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ã€Œé£Ÿã¹ãŸããªã„ã€ã‚’èª¿æ•´ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ðŸ”",noFilteredResults:"æ¡ä»¶ã«åˆã†åº—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’èª¿æ•´ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ðŸ”",geoError:"ä½ç½®æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã€‚è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚",noGeo:"ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ä½ç½®æƒ…å ±ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚",locationTitle:"ã©ã®è¾ºã§é£Ÿã¹ã‚‹ï¼Ÿ",searchPlaceholder:"ðŸ” å ´æ‰€ã‚’æ¤œç´¢",useCurrentLocation:"ðŸ“ ç¾åœ¨åœ°ã‚’ä½¿ç”¨",installBtn:"ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ðŸ“²",iosInstallText:"ã‚¢ãƒ—ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³• ðŸ“²",iosInstallAlert:`ã€Œä½•é£Ÿã¹ã‚‹ï¼Ÿã€ã‚’ã‚¢ãƒ—ãƒªã®ã‚ˆã†ã«ä½¿ã†æ–¹æ³•ï¼š

1. Safari ã®å…±æœ‰ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆå››è§’ã«ä¸ŠçŸ¢å°ï¼‰ã‚’ã‚¿ãƒƒãƒ—
2. ä¸‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ã€Œãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ã€ã‚’ã‚¿ãƒƒãƒ—

å®Œäº†ã§ã™ï¼âœ¨`,linkCopied:"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼ðŸ“‹",categories:{chinese:"ðŸš ä¸­è¯æ–™ç†",japanese:"ðŸ£ æ—¥æœ¬æ–™ç†",korean:"ðŸ‡°ðŸ‡· éŸ“å›½æ–™ç†",western:"ðŸ• æ´‹é£Ÿ",se_asian:"ðŸ² æ±å—äºž",indian_middle_east:"ðŸ•Œ ã‚¤ãƒ³ãƒ‰/ä¸­æ±æ–™ç†",noodles:"ðŸœ éººé¡ž",rice_bento:"ðŸ± ã”é£¯/å®šé£Ÿ/å¼å½“",sushi_sashimi:"ðŸ£ å¯¿å¸/åˆºèº«",burger_pizza:"ðŸ• ãƒãƒ¼ã‚¬ãƒ¼/ãƒ”ã‚¶",hotpot_bbq:"ðŸ”¥ ç«é‹/ç„¼è‚‰",dim_sum:"ðŸ¥Ÿ ç‚¹å¿ƒ",fine_dining_buffet:"ðŸ¥‚ é«˜ç´š/ãƒ“ãƒ¥ãƒƒãƒ•ã‚§",all_day_brunch:"ðŸ³ ãƒ–ãƒ©ãƒ³ãƒ",bar_izakaya:"ðŸ¹ ãƒãƒ¼/å±…é…’å±‹",spicy:"ðŸŒ¶ï¸ è¾›ã„æ–™ç†",dessert:"ðŸ§ ãƒ‡ã‚¶ãƒ¼ãƒˆ",fast_food:"ðŸ” ãƒ•ã‚¡ã‚¹ãƒˆãƒ•ãƒ¼ãƒ‰",healthy_vege:"ðŸ¥¦ ãƒ˜ãƒ«ã‚·ãƒ¼/ãƒ™ã‚¸"},unknownName:"ä¸æ˜Ž",noAddress:"ä½æ‰€ä¸æ˜Ž",ratingNew:"â­ æ–°è¦ã‚ªãƒ¼ãƒ—ãƒ³ï¼",noHoursInfo:"å–¶æ¥­æ™‚é–“æƒ…å ±ãªã—",priceFree:"ç„¡æ–™",walkMins:"ðŸš¶ å¾’æ­© ${mins} åˆ†",shareBtn:"ðŸ“¤ ã‚·ã‚§ã‚¢",shareText:"ã€Œãƒ¡ã‚·æ±ºã€ã§ã“ã‚Œã‚’é¸ã‚“ã ã‚ˆï¼š${name}ï¼ä¸€ç·’ã«ã©ã†ï¼ŸðŸ¥—",includeClosed:"å–¶æ¥­æ™‚é–“å¤–ã‚‚å«ã‚€ ðŸŒ™",excludeClosed:"å–¶æ¥­ä¸­ã®ã¿ â˜€ï¸",reviews:"å£ã‚³ãƒŸ",viewAllPhotos:"ã‚‚ã£ã¨è¦‹ã‚‹",photosTitle:"å†™çœŸ",viewAllReviews:"ã‚‚ã£ã¨è¦‹ã‚‹"}},u=e=>document.getElementById(e);function Be(e={}){return new Promise((t,r)=>{if(!navigator.geolocation){r(new Error("GEOLOCATION_NOT_SUPPORTED"));return}navigator.geolocation.getCurrentPosition(t,r,{enableHighAccuracy:!0,timeout:5e3,maximumAge:0,...e})})}function re(e,t){if(!t||t.length===0)return!1;const r=(e.name||"").toLowerCase(),i=e.types||[];return t.some(a=>r.includes(a.toLowerCase())||i.some(o=>o.toLowerCase().includes(a.toLowerCase())))}const W={chinese:["chinese_restaurant","asian_restaurant","chinese","cantonese","shanghainese","sichuan","dim sum","congee","ä¸­èœ","ä¸­å¼","ç²µèœ","ä¸Šæµ·","å·èœ","äº¬èœ","é»žå¿ƒ","ç²¥","ç‡’å‘³"],japanese:["japanese_restaurant","sushi_restaurant","ramen_restaurant","japanese","sushi","ramen","izakaya","udon","soba","yakitori","tonkatsu","æ—¥æœ¬","å£½å¸","æ‹‰éºµ","å±…é…’å±‹","çƒå†¬","è•Žéº¥","ç‡’é³¥","ä¸¼","å¤©å©¦ç¾…"],korean:["korean_restaurant","korean","kimchi","bibimbap","bbq","éŸ“åœ‹","éŸ“å¼","æ³¡èœ","é£¯å·","éŸ“ç‡’","ç‚¸é›ž"],western:["italian_restaurant","french_restaurant","american_restaurant","hamburger_restaurant","pizza_restaurant","steak_house","brazilian_restaurant","greek_restaurant","mediterranean_restaurant","mexican_restaurant","seafood_restaurant","spanish_restaurant","buffet_restaurant","fine_dining_restaurant","steak","italian","french","burger","pasta","pizza","western","mexican","spanish","è¥¿é¤","æ„å¼","æ³•å¼","æ¼¢å ¡","è–„é¤…","ç‰›æ‰’","æ‰’æˆ¿","è‡ªåŠ©é¤"],se_asian:["thai_restaurant","vietnamese_restaurant","indonesian_restaurant","thai","vietnamese","malaysian","singaporean","indonesian","æ³°åœ‹","è¶Šå—","æ˜Ÿé¦¬","å°å°¼","æ³°å¼","è¶Šå¼","æµ·å—é›ž","å†¬è”­åŠŸ","å–‡æ²™"],noodles:["ramen_restaurant","noodle","ramen","udon","pho","ç±³ç·š","æ‹‰éºµ","éºµ","ç²‰","æ²³","é›²åž"],spicy:["spicy","sichuan","mala","chili","å·èœ","éº»è¾£","è¾£","æ°´ç…®","é…¸è¾£","æ¹˜èœ"],hotpot_bbq:["barbecue_restaurant","steak_house","hot pot","hotpot","bbq","barbecue","grill","yakiniku","ç«é‹","é›žç…²","ç‡’è‚‰","éŸ“ç‡’","ç‡’çƒ¤","ä¸²ç‡’","æ‰“é‚Šçˆ","è‚‰","æ‰’","bbq"],dim_sum:["chinese_restaurant","dim sum","yum cha","dumpling","é»žå¿ƒ","é£²èŒ¶","é¤ƒå­","ç›…é£¯","åŒ…é»ž"],dessert:["bakery","ice_cream_shop","dessert_restaurant","dessert_shop","confectionery","chocolate_factory","chocolate_shop","candy_store","donut_shop","dessert","sugar","sweet","bakery","cake","ice cream","ç³–æ°´","ç”œ","é›ªç³•","å†°","è›‹ç³•","é¤…","ç­æˆŸ"],fast_food:["fast_food_restaurant","hamburger_restaurant","sandwich_shop","fast food","food_court","mcdonald","kfc","burger","sandwich","å¿«é¤","å°é£Ÿ","æ¼¢å ¡","ä¸‰æ–‡æ²»","ç‚¸é›ž","ç†±ç‹—","deli"],indian_middle_east:["indian_restaurant","lebanese_restaurant","turkish_restaurant","middle_eastern_restaurant","afghani_restaurant","indian","curry","middle eastern","kebab","å°åº¦","å’–å“©","ä¸­æ±","åœŸè€³å…¶"],healthy_vege:["vegan_restaurant","vegetarian_restaurant","acai_shop","juice_shop","vegan","vegetarian","healthy","organic","salad","ç´ é£Ÿ","å¥åº·","æ²™å¾‹","æœ‰æ©Ÿ"],sushi_sashimi:["sushi_restaurant","japanese_restaurant","sushi","sashimi","å£½å¸","åˆºèº«","æ—¥æœ¬","omakase"],burger_pizza:["hamburger_restaurant","pizza_restaurant","burger","pizza","æ¼¢å ¡","è–„é¤…","æ¼¢å ¡åŒ…","æ„ç²‰"],rice_bento:["restaurant","bento","rice","donburi","é£¯","å®šé£Ÿ","ä¾¿ç•¶","ä¸¼","ç›…é£¯","ç…²ä»”é£¯"],fine_dining_buffet:["fine_dining_restaurant","buffet_restaurant","steak_house","french_restaurant","é«˜ç´š","æ…¶ç¥","è‡ªåŠ©é¤","æ”¾é¡Œ","omakase","fine dining","buffet"],all_day_brunch:["breakfast_restaurant","brunch_restaurant","cafe","tea_house","brunch","breakfast","pancake","å…¨æ—¥æ—©é¤","æ—©åˆé¤","ç­æˆŸ","èˆ’èŠ™è•¾","é¬†é¤…","cat_cafe","dog_cafe"],bar_izakaya:["bar","bar_and_grill","izakaya","pub","é…’","å±…é…’å±‹","é…’å§","ä¸²ç‡’","yakitori","kebab","bar","wine_bar"]},ne=["asian_restaurant","chinese_restaurant","indian_restaurant","indonesian_restaurant","japanese_restaurant","korean_restaurant","ramen_restaurant","sushi_restaurant","thai_restaurant","vietnamese_restaurant","lebanese_restaurant","turkish_restaurant","middle_eastern_restaurant","afghani_restaurant","african_restaurant","american_restaurant","barbecue_restaurant","brazilian_restaurant","french_restaurant","greek_restaurant","italian_restaurant","mediterranean_restaurant","mexican_restaurant","pizza_restaurant","seafood_restaurant","spanish_restaurant","steak_house","buffet_restaurant","fine_dining_restaurant","restaurant","bar_and_grill","bar","vegan_restaurant","vegetarian_restaurant","cat_cafe","chinese_restaurant","chocolate_factory","chocolate_shop","coffee_shop","confectionery","deli","dessert_restaurant","dessert_shop","diner","dog_cafe","donut_shop","fast_food_restaurant","fine_dining_restaurant","food_court","french_restaurant","greek_restaurant","hamburger_restaurant","ice_cream_shop","indian_restaurant","indonesian_restaurant","italian_restaurant","japanese_restaurant","juice_shop","korean_restaurant","lebanese_restaurant","meal_delivery","meal_takeaway","mediterranean_restaurant","mexican_restaurant","middle_eastern_restaurant","pizza_restaurant","pub","ramen_restaurant","restaurant","sandwich_shop","seafood_restaurant","spanish_restaurant","steak_house","sushi_restaurant","tea_house","thai_restaurant","turkish_restaurant","vegan_restaurant","vegetarian_restaurant","vietnamese_restaurant","wine_bar"],G=["id","displayName","location","rating","userRatingCount","regularOpeningHours","priceLevel","businessStatus","types","utcOffsetMinutes"],ie=["id","formattedAddress","regularOpeningHours","nationalPhoneNumber","photos","reviews","googleMapsURI","googleMapsLinks"],oe={PRICE_LEVEL_FREE:{val:"0",label:e=>e.priceFree},PRICE_LEVEL_INEXPENSIVE:{val:"1",label:()=>"$"},PRICE_LEVEL_MODERATE:{val:"2",label:()=>"$$"},PRICE_LEVEL_EXPENSIVE:{val:"3",label:()=>"$$$"},PRICE_LEVEL_VERY_EXPENSIVE:{val:"4",label:()=>"$$$$"}},q={0:"PRICE_LEVEL_FREE",1:"PRICE_LEVEL_INEXPENSIVE",2:"PRICE_LEVEL_MODERATE",3:"PRICE_LEVEL_EXPENSIVE",4:"PRICE_LEVEL_VERY_EXPENSIVE"},B={DEFAULT_SEARCH_RADIUS_MULTIPLIER:80,DEFAULT_MINS:5,HAPTIC_FEEDBACK_DURATION:{SHORT:30},METERS_PER_DEGREE_LAT:111320};function K(e,t){return{id:e.id||e.place_id,name:typeof e.displayName=="string"?e.displayName:e.displayName?.text||t.unknownName,rating:e.rating,userRatingCount:e.userRatingCount||0,vicinity:e.formattedAddress||e.vicinity||t.noAddress,types:e.types||[],priceLevel:e.priceLevel,phone:e.nationalPhoneNumber,businessStatus:e.businessStatus,location:e.location,openingHours:e.regularOpeningHours,isOpen:null,durationText:null,durationValue:null,photos:e.photos||[],reviews:e.reviews||[],googleMapsUri:e.googleMapsURI||e.googleMapsUri||e.googleMapsLinks?.placeURI||e.googleMapsLinks?.placeUri,reviewsUri:e.googleMapsLinks?.reviewsUri||e.googleMapsLinks?.reviewsURI,photosUri:e.googleMapsLinks?.photosUri||e.googleMapsLinks?.photosURI}}async function se(e){e.UI.triggerHaptic(50),e.UI.showScreen("loading-screen"),e.Data.history=[];const t=e.translations[e.currentLang];try{let r;e.Data.manualLocation?r={coords:{latitude:e.Data.manualLocation.lat,longitude:e.Data.manualLocation.lng}}:r=await Be();const{latitude:i,longitude:a}=r.coords;e.Data.userPos={lat:i,lng:a};const{Place:o}=await google.maps.importLibrary("places"),l=await le(o,e.Data.userPos,e.Config.radius,e);if(!l||l.length===0){alert(t.noResults),e.UI.showScreen("main-flow");return}const d=await ce(l,e.Data.userPos,e);if(d.length===0){const C=e.Config.filterMode==="whitelist"?t.noFilteredResultsWhitelist:t.noFilteredResultsBlacklist;alert(C),e.UI.showScreen("main-flow");return}e.Data.candidates=d;const c=d[Math.floor(Math.random()*d.length)];e.Data.currentPlace=await de(o,c,e),e.UI.startSlotAnimation(e)}catch(r){console.error("Search Error:",r),je(r,t,e)}}async function le(e,t,r,i){const a=Fe(t,r),o=He(i),l=[],d=new Set,c=async(p,g)=>{const E={locationRestriction:{center:p,radius:r},includedPrimaryTypes:g,fields:G,maxResultCount:20,rankPreference:"DISTANCE"};try{const{places:k}=await e.searchNearby(E);return k||[]}catch(k){return console.warn("Fetch error:",k),[]}},C=p=>{let g=0;return p.forEach(E=>{E&&E.id&&!d.has(E.id)&&(d.add(E.id),l.push(E),g++)}),g};for(const p of o){if(!p||p.length===0)continue;const g=await c(a[0],p);if(C(g),g.length<20)continue;const E=await Promise.all([c(a[1],p),c(a[4],p)]);let k=0;if(E.forEach(F=>{k+=C(F)}),k===0)continue;(await Promise.all([c(a[2],p),c(a[3],p)])).forEach(F=>C(F))}return l}function Fe(e,t){const r=t*.6,i=r/B.METERS_PER_DEGREE_LAT,a=r/(B.METERS_PER_DEGREE_LAT*Math.cos(e.lat*Math.PI/180));return[{lat:e.lat,lng:e.lng},{lat:e.lat-i,lng:e.lng-a},{lat:e.lat+i,lng:e.lng-a},{lat:e.lat-i,lng:e.lng+a},{lat:e.lat+i,lng:e.lng+a}]}function He(e){const t=[],r=ne;if(e.Config.filterMode==="whitelist"&&e.Config.excluded.size>0){const i=new Set;e.Config.excluded.forEach(o=>{(W[o]||[]).forEach(l=>{ne.includes(l)&&i.add(l)})});const a=Array.from(i);for(let o=0;o<a.length;o+=20)t.push(a.slice(o,o+20))}else if(e.Config.filterMode==="blacklist"&&e.Config.excluded.size>0){const i=new Set;e.Config.excluded.forEach(o=>{(W[o]||[]).forEach(l=>{(l.includes("_")||/^[a-z]+$/.test(l))&&i.add(l)})});const a=r.filter(o=>!i.has(o));for(let o=0;o<a.length;o+=20)t.push(a.slice(o,o+20))}if(t.length===0)for(let i=0;i<r.length;i+=20)t.push(r.slice(i,i+20));return t}async function ce(e,t,r){const i=r.translations[r.currentLang],a=await ze(e,r,i),o=await We(t,a,r);return Ve(o,r)}async function ze(e,t,r){return(await Promise.all(e.map(async a=>{const o=K(a,r);try{o.isOpen=await a.isOpen()}catch{o.isOpen=null}return o.isOpen===null&&(o.isOpen=o.openingHours?.periods?Ae(o.openingHours.periods):o.openingHours?.openNow),o}))).filter(a=>a.businessStatus!=="OPERATIONAL"&&a.businessStatus?!1:t.Config.includeClosed||a.isOpen!==!1)}async function We(e,t,r){const i=await ue(e,t);let a=i.filter(o=>!o.durationValue||o.durationValue/60<=r.Config.mins);return a.length===0&&(a=i.sort((o,l)=>(o.durationValue||9999)-(l.durationValue||9999)).slice(0,3)),a}function Ve(e,t){return e.filter(r=>{const i=Array.from(t.Config.excluded),a=i.some(o=>re(r,W[o]));if(t.Config.filterMode==="whitelist"){if(i.length>0&&!a)return!1}else if(a)return!1;if(r.priceLevel!==void 0&&r.priceLevel!==null){const o=q[r.priceLevel]||r.priceLevel,l=oe[o];if(l&&t.Config.prices.size>0&&!t.Config.prices.has(l.val))return!1}return!0})}function Ae(e){if(!e||!Array.isArray(e)||e.length===0)return null;if(e.length===1&&!e[0].close)return!0;const t=new Date,r=t.getDay()*1440+t.getHours()*60+t.getMinutes(),i=10080;for(const a of e){if(!a.open||!a.close)continue;const o=Number(a.open.day)*1440+Number(a.open.hour)*60+Number(a.open.minute);let l=Number(a.close.day)*1440+Number(a.close.hour)*60+Number(a.close.minute);if(l<=o&&(l+=i),r>=o&&r<l||r+i>=o&&r+i<l)return!0}return!1}async function de(e,t,r){if(!t||!t.id)return t;const i=`place_detail_${t.id}`,a=Date.now(),o=1440*60*1e3,l=d=>d&&d.map(c=>({...c,getURI:C=>c.cachedURI||""}));try{const d=localStorage.getItem(i);if(d){const{data:c,timestamp:C}=JSON.parse(d);if(a-C<o){c.photos&&(c.photos=l(c.photos)),delete c.durationText,delete c.durationValue;const{durationText:p,durationValue:g}=t;return Object.assign(t,c),p&&(t.durationText=p),g&&(t.durationValue=g),t}}}catch(d){console.warn("Cache read error:",d)}try{const d=new e({id:t.id});await d.fetchFields({fields:[...G,...ie]});const c=r.translations[r.currentLang],C=K(d,c);d.photos&&d.photos.length>0&&(C.photos=d.photos.map(E=>({cachedURI:E.getURI({maxHeight:1e3}),widthPx:E.widthPx,heightPx:E.heightPx,authorAttributions:E.authorAttributions})));const{durationText:p,durationValue:g}=t;Object.assign(t,C),p&&(t.durationText=p),g&&(t.durationValue=g),localStorage.setItem(i,JSON.stringify({data:C,timestamp:a})),t.photos&&(t.photos=l(t.photos))}catch(d){console.error("Error fetching place details:",d)}return t}function je(e,t,r){e.message==="GEOLOCATION_NOT_SUPPORTED"?alert(t.noGeo):e.code===1?alert(t.geoError):alert("Error: "+e.message),r.UI.showScreen("main-flow")}async function ue(e,t){if(t.length===0)return[];const r=25,i=[];for(let l=0;l<t.length;l+=r)i.push(t.slice(l,l+r));const a=new google.maps.DistanceMatrixService;return(await Promise.all(i.map(l=>new Promise(d=>{a.getDistanceMatrix({origins:[e],destinations:l.map(c=>c.location),travelMode:google.maps.TravelMode.WALKING,unitSystem:google.maps.UnitSystem.METRIC},(c,C)=>{if(C!=="OK"){d(l.map(g=>({...g,durationText:null,durationValue:null})));return}const p=c.rows[0].elements;d(l.map((g,E)=>({...g,durationText:p[E].status==="OK"?p[E].duration.text:null,durationValue:p[E].status==="OK"?p[E].duration.value:null})))})})))).flat()}async function he(e){if(e.UI.triggerHaptic([50,30,50]),e.Data.candidates.length===0)return se(e);let t=e.Data.candidates;if(t.length>1){const o=new Set(e.Data.history||[]),l=t.filter(d=>!o.has(d.id));if(l.length>0)t=l;else if(e.Data.lastPickedId){const d=t.filter(c=>c.id!==e.Data.lastPickedId);d.length>0&&(t=d)}}let r=t[Math.floor(Math.random()*t.length)];const{Place:i}=await google.maps.importLibrary("places"),a=await de(i,r,e);e.UI.showResult(e,a)}async function $e(e){const t=e.Data.params.get("resId");if(t){window.history.replaceState({},document.title,window.location.pathname),e.UI.showScreen("loading-screen");try{const{Place:r}=await google.maps.importLibrary("places"),i=new r({id:t});await i.fetchFields({fields:[...G,...ie]});const a=parseFloat(e.Data.params.get("lat")),o=parseFloat(e.Data.params.get("lng"));!isNaN(a)&&!isNaN(o)&&(e.Data.userPos={lat:a,lng:o});const l=e.translations[e.currentLang],d=K(i,l);if(e.Data.userPos&&d.location){const[c]=await ue(e.Data.userPos,[d]);d.durationValue=c.durationValue,d.durationText=c.durationText}if(e.Data.userPos){const c=await le(r,e.Data.userPos,e.Config.radius,e);c&&c.length>0&&(e.Data.candidates=await ce(c,e.Data.userPos,e))}e.UI.showResult(e,d,{fromShare:!0})}catch(r){console.error("Session restoration failed:",r),e.UI.showScreen("main-flow")}}}function qe(){const e=()=>{const t=Date.now(),r=1440*60*1e3;let i=0;try{for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);if(o&&o.startsWith("place_detail_"))try{const l=localStorage.getItem(o);if(l){const{timestamp:d}=JSON.parse(l);t-d>r&&(localStorage.removeItem(o),i++,a--)}}catch{localStorage.removeItem(o)}}}catch(a){console.warn("Garbage collection failed:",a)}};"requestIdleCallback"in window?requestIdleCallback(e,{timeout:5e3}):setTimeout(e,2e3)}var J={};(function e(t,r,i,a){var o=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),l=typeof Path2D=="function"&&typeof DOMMatrix=="function",d=(function(){if(!t.OffscreenCanvas)return!1;try{var s=new OffscreenCanvas(1,1),n=s.getContext("2d");n.fillRect(0,0,1,1);var h=s.transferToImageBitmap();n.createPattern(h,"no-repeat")}catch{return!1}return!0})();function c(){}function C(s){var n=r.exports.Promise,h=n!==void 0?n:t.Promise;return typeof h=="function"?new h(s):(s(c,c),null)}var p=(function(s,n){return{transform:function(h){if(s)return h;if(n.has(h))return n.get(h);var m=new OffscreenCanvas(h.width,h.height),y=m.getContext("2d");return y.drawImage(h,0,0),n.set(h,m),m},clear:function(){n.clear()}}})(d,new Map),g=(function(){var s=Math.floor(16.666666666666668),n,h,m={},y=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(n=function(v){var w=Math.random();return m[w]=requestAnimationFrame(function f(_){y===_||y+s-1<_?(y=_,delete m[w],v()):m[w]=requestAnimationFrame(f)}),w},h=function(v){m[v]&&cancelAnimationFrame(m[v])}):(n=function(v){return setTimeout(v,s)},h=function(v){return clearTimeout(v)}),{frame:n,cancel:h}})(),E=(function(){var s,n,h={};function m(y){function v(w,f){y.postMessage({options:w||{},callback:f})}y.init=function(f){var _=f.transferControlToOffscreen();y.postMessage({canvas:_},[_])},y.fire=function(f,_,I){if(n)return v(f,null),n;var M=Math.random().toString(36).slice(2);return n=C(function(L){function P(x){x.data.callback===M&&(delete h[M],y.removeEventListener("message",P),n=null,p.clear(),I(),L())}y.addEventListener("message",P),v(f,M),h[M]=P.bind(null,{data:{callback:M}})}),n},y.reset=function(){y.postMessage({reset:!0});for(var f in h)h[f](),delete h[f]}}return function(){if(s)return s;if(!i&&o){var y=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{s=new Worker(URL.createObjectURL(new Blob([y])))}catch(v){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("ðŸŽŠ Could not load worker",v),null}m(s)}return s}})(),k={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function z(s,n){return n?n(s):s}function F(s){return s!=null}function S(s,n,h){return z(s&&F(s[n])?s[n]:k[n],h)}function fe(s){return s<0?0:Math.floor(s)}function ge(s,n){return Math.floor(Math.random()*(n-s))+s}function V(s){return parseInt(s,16)}function me(s){return s.map(pe)}function pe(s){var n=String(s).replace(/[^0-9a-f]/gi,"");return n.length<6&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),{r:V(n.substring(0,2)),g:V(n.substring(2,4)),b:V(n.substring(4,6))}}function ye(s){var n=S(s,"origin",Object);return n.x=S(n,"x",Number),n.y=S(n,"y",Number),n}function ve(s){s.width=document.documentElement.clientWidth,s.height=document.documentElement.clientHeight}function we(s){var n=s.getBoundingClientRect();s.width=n.width,s.height=n.height}function _e(s){var n=document.createElement("canvas");return n.style.position="fixed",n.style.top="0px",n.style.left="0px",n.style.pointerEvents="none",n.style.zIndex=s,n}function be(s,n,h,m,y,v,w,f,_){s.save(),s.translate(n,h),s.rotate(v),s.scale(m,y),s.arc(0,0,1,w,f,_),s.restore()}function Ce(s){var n=s.angle*(Math.PI/180),h=s.spread*(Math.PI/180);return{x:s.x,y:s.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:s.startVelocity*.5+Math.random()*s.startVelocity,angle2D:-n+(.5*h-Math.random()*h),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:s.color,shape:s.shape,tick:0,totalTicks:s.ticks,decay:s.decay,drift:s.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:s.gravity*3,ovalScalar:.6,scalar:s.scalar,flat:s.flat}}function Ee(s,n){n.x+=Math.cos(n.angle2D)*n.velocity+n.drift,n.y+=Math.sin(n.angle2D)*n.velocity+n.gravity,n.velocity*=n.decay,n.flat?(n.wobble=0,n.wobbleX=n.x+10*n.scalar,n.wobbleY=n.y+10*n.scalar,n.tiltSin=0,n.tiltCos=0,n.random=1):(n.wobble+=n.wobbleSpeed,n.wobbleX=n.x+10*n.scalar*Math.cos(n.wobble),n.wobbleY=n.y+10*n.scalar*Math.sin(n.wobble),n.tiltAngle+=.1,n.tiltSin=Math.sin(n.tiltAngle),n.tiltCos=Math.cos(n.tiltAngle),n.random=Math.random()+2);var h=n.tick++/n.totalTicks,m=n.x+n.random*n.tiltCos,y=n.y+n.random*n.tiltSin,v=n.wobbleX+n.random*n.tiltCos,w=n.wobbleY+n.random*n.tiltSin;if(s.fillStyle="rgba("+n.color.r+", "+n.color.g+", "+n.color.b+", "+(1-h)+")",s.beginPath(),l&&n.shape.type==="path"&&typeof n.shape.path=="string"&&Array.isArray(n.shape.matrix))s.fill(Le(n.shape.path,n.shape.matrix,n.x,n.y,Math.abs(v-m)*.1,Math.abs(w-y)*.1,Math.PI/10*n.wobble));else if(n.shape.type==="bitmap"){var f=Math.PI/10*n.wobble,_=Math.abs(v-m)*.1,I=Math.abs(w-y)*.1,M=n.shape.bitmap.width*n.scalar,L=n.shape.bitmap.height*n.scalar,P=new DOMMatrix([Math.cos(f)*_,Math.sin(f)*_,-Math.sin(f)*I,Math.cos(f)*I,n.x,n.y]);P.multiplySelf(new DOMMatrix(n.shape.matrix));var x=s.createPattern(p.transform(n.shape.bitmap),"no-repeat");x.setTransform(P),s.globalAlpha=1-h,s.fillStyle=x,s.fillRect(n.x-M/2,n.y-L/2,M,L),s.globalAlpha=1}else if(n.shape==="circle")s.ellipse?s.ellipse(n.x,n.y,Math.abs(v-m)*n.ovalScalar,Math.abs(w-y)*n.ovalScalar,Math.PI/10*n.wobble,0,2*Math.PI):be(s,n.x,n.y,Math.abs(v-m)*n.ovalScalar,Math.abs(w-y)*n.ovalScalar,Math.PI/10*n.wobble,0,2*Math.PI);else if(n.shape==="star")for(var b=Math.PI/2*3,R=4*n.scalar,D=8*n.scalar,N=n.x,U=n.y,H=5,O=Math.PI/H;H--;)N=n.x+Math.cos(b)*D,U=n.y+Math.sin(b)*D,s.lineTo(N,U),b+=O,N=n.x+Math.cos(b)*R,U=n.y+Math.sin(b)*R,s.lineTo(N,U),b+=O;else s.moveTo(Math.floor(n.x),Math.floor(n.y)),s.lineTo(Math.floor(n.wobbleX),Math.floor(y)),s.lineTo(Math.floor(v),Math.floor(w)),s.lineTo(Math.floor(m),Math.floor(n.wobbleY));return s.closePath(),s.fill(),n.tick<n.totalTicks}function Ie(s,n,h,m,y){var v=n.slice(),w=s.getContext("2d"),f,_,I=C(function(M){function L(){f=_=null,w.clearRect(0,0,m.width,m.height),p.clear(),y(),M()}function P(){i&&!(m.width===a.width&&m.height===a.height)&&(m.width=s.width=a.width,m.height=s.height=a.height),!m.width&&!m.height&&(h(s),m.width=s.width,m.height=s.height),w.clearRect(0,0,m.width,m.height),v=v.filter(function(x){return Ee(w,x)}),v.length?f=g.frame(P):L()}f=g.frame(P),_=L});return{addFettis:function(M){return v=v.concat(M),I},canvas:s,promise:I,reset:function(){f&&g.cancel(f),_&&_()}}}function Z(s,n){var h=!s,m=!!S(n||{},"resize"),y=!1,v=S(n,"disableForReducedMotion",Boolean),w=o&&!!S(n||{},"useWorker"),f=w?E():null,_=h?ve:we,I=s&&f?!!s.__confetti_initialized:!1,M=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,L;function P(b,R,D){for(var N=S(b,"particleCount",fe),U=S(b,"angle",Number),H=S(b,"spread",Number),O=S(b,"startVelocity",Number),Se=S(b,"decay",Number),Te=S(b,"gravity",Number),ke=S(b,"drift",Number),Y=S(b,"colors",me),xe=S(b,"ticks",Number),Q=S(b,"shapes"),Re=S(b,"scalar"),De=!!S(b,"flat"),ee=ye(b),te=N,j=[],Ne=s.width*ee.x,Oe=s.height*ee.y;te--;)j.push(Ce({x:Ne,y:Oe,angle:U,spread:H,startVelocity:O,color:Y[te%Y.length],shape:Q[ge(0,Q.length)],ticks:xe,decay:Se,gravity:Te,drift:ke,scalar:Re,flat:De}));return L?L.addFettis(j):(L=Ie(s,j,_,R,D),L.promise)}function x(b){var R=v||S(b,"disableForReducedMotion",Boolean),D=S(b,"zIndex",Number);if(R&&M)return C(function(O){O()});h&&L?s=L.canvas:h&&!s&&(s=_e(D),document.body.appendChild(s)),m&&!I&&_(s);var N={width:s.width,height:s.height};f&&!I&&f.init(s),I=!0,f&&(s.__confetti_initialized=!0);function U(){if(f){var O={getBoundingClientRect:function(){if(!h)return s.getBoundingClientRect()}};_(O),f.postMessage({resize:{width:O.width,height:O.height}});return}N.width=N.height=null}function H(){L=null,m&&(y=!1,t.removeEventListener("resize",U)),h&&s&&(document.body.contains(s)&&document.body.removeChild(s),s=null,I=!1)}return m&&!y&&(y=!0,t.addEventListener("resize",U,!1)),f?f.fire(b,N,H):P(b,N,H)}return x.reset=function(){f&&f.reset(),L&&L.reset()},x}var A;function X(){return A||(A=Z(null,{useWorker:!0,resize:!0})),A}function Le(s,n,h,m,y,v,w){var f=new Path2D(s),_=new Path2D;_.addPath(f,new DOMMatrix(n));var I=new Path2D;return I.addPath(_,new DOMMatrix([Math.cos(w)*y,Math.sin(w)*y,-Math.sin(w)*v,Math.cos(w)*v,h,m])),I}function Me(s){if(!l)throw new Error("path confetti are not supported in this browser");var n,h;typeof s=="string"?n=s:(n=s.path,h=s.matrix);var m=new Path2D(n),y=document.createElement("canvas"),v=y.getContext("2d");if(!h){for(var w=1e3,f=w,_=w,I=0,M=0,L,P,x=0;x<w;x+=2)for(var b=0;b<w;b+=2)v.isPointInPath(m,x,b,"nonzero")&&(f=Math.min(f,x),_=Math.min(_,b),I=Math.max(I,x),M=Math.max(M,b));L=I-f,P=M-_;var R=10,D=Math.min(R/L,R/P);h=[D,0,0,D,-Math.round(L/2+f)*D,-Math.round(P/2+_)*D]}return{type:"path",path:n,matrix:h}}function Pe(s){var n,h=1,m="#000000",y='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof s=="string"?n=s:(n=s.text,h="scalar"in s?s.scalar:h,y="fontFamily"in s?s.fontFamily:y,m="color"in s?s.color:m);var v=10*h,w=""+v+"px "+y,f=new OffscreenCanvas(v,v),_=f.getContext("2d");_.font=w;var I=_.measureText(n),M=Math.ceil(I.actualBoundingBoxRight+I.actualBoundingBoxLeft),L=Math.ceil(I.actualBoundingBoxAscent+I.actualBoundingBoxDescent),P=2,x=I.actualBoundingBoxLeft+P,b=I.actualBoundingBoxAscent+P;M+=P+P,L+=P+P,f=new OffscreenCanvas(M,L),_=f.getContext("2d"),_.font=w,_.fillStyle=m,_.fillText(n,x,b);var R=1/h;return{type:"bitmap",bitmap:f.transferToImageBitmap(),matrix:[R,0,0,R,-M*R/2,-L*R/2]}}r.exports=function(){return X().apply(this,arguments)},r.exports.reset=function(){X().reset()},r.exports.create=Z,r.exports.shapeFromPath=Me,r.exports.shapeFromText=Pe})((function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}})(),J,!1);const $=J.exports;J.exports.create;const Ge={showScreen(e){["main-flow","result-screen","loading-screen"].forEach(o=>{const l=u(o);l&&l.classList.toggle("hidden",o!==e)});const r=u("footer-home"),i=u("footer-result"),a=u("app-footer");e==="main-flow"?(a&&a.classList.remove("hidden"),r&&r.classList.remove("hidden"),i&&i.classList.add("hidden")):e==="result-screen"?(a&&a.classList.remove("hidden"),r&&r.classList.add("hidden"),i&&i.classList.remove("hidden")):a&&a.classList.add("hidden")},updateStrings(e){const t=e.translations[e.currentLang],r={"location-title":t.locationTitle,"app-title":t.title,"app-subtitle":t.subtitle,"price-title":t.priceTitle,"filter-title":e.Config.filterMode==="whitelist"?t.filterModeWhitelist:t.filterModeBlacklist,"find-btn":t.findBtn,"retry-btn":t.retry,"back-btn":t.backBtn,"loading-text":t.loading,"open-maps-btn":t.openMaps,"share-btn":t.shareBtn,"install-btn":t.installBtn,"reviews-title":t.reviews,"view-all-reviews":t.viewAllReviews,"photos-title":t.photosTitle,"view-all-photos":t.viewAllPhotos};Object.entries(r).forEach(([c,C])=>{const p=u(c);p&&(p.textContent=C)});const i=u("location-input");i&&(i.placeholder=t.searchPlaceholder);const a=u("location-display");a&&!e.Data.manualLocation&&(a.textContent=t.useCurrentLocation);const o=u("distance-title");if(o){o.textContent="",o.appendChild(document.createTextNode(`${t.distanceTitle} (`));const c=document.createElement("span");c.id="distance-val",c.textContent=e.Config.mins,o.appendChild(c),o.appendChild(document.createTextNode(" mins)"))}const l=u("include-closed-btn");if(l){const c=e.Config.includeClosed;l.classList.toggle("active",c);const C=u("include-closed-label");C&&(C.textContent=c?t.includeClosed:t.excludeClosed)}const d=u("filter-mode-label");d&&(d.textContent=e.Config.filterMode==="whitelist"?t.filterToggleBlacklist:t.filterToggleWhitelist),document.querySelectorAll(".lang-selector span").forEach(c=>{c.classList.toggle("active",c.dataset.lang===e.currentLang)})},initFilters(e){const t=u("filter-list");if(!t)return;t.innerHTML="";const r=e.translations[e.currentLang].categories;Object.keys(r).forEach(i=>{const a=document.createElement("div");a.className=`filter-item ${e.Config.excluded.has(i)?"active":""}`,a.textContent=r[i],a.onclick=()=>{e.Config.excluded.has(i)?(e.Config.excluded.delete(i),a.classList.remove("active")):(e.Config.excluded.add(i),a.classList.add("active")),e.saveSettings(),this.triggerHaptic(B.HAPTIC_FEEDBACK_DURATION.SHORT)},t.appendChild(a)}),document.querySelectorAll(".price-item").forEach(i=>{const a=i.dataset.price;i.classList.toggle("active",e.Config.prices.has(a)),i.onclick=()=>{e.Config.prices.has(a)?(e.Config.prices.delete(a),i.classList.remove("active")):(e.Config.prices.add(a),i.classList.add("active")),e.saveSettings(),this.triggerHaptic(B.HAPTIC_FEEDBACK_DURATION.SHORT)}})},async showResult(e,t,r={}){const{fromShare:i=!1}=r;this.showScreen("result-screen"),e.Data.currentPlace=t,this.updateHistory(e,t);const a=this.getElements();if(this.renderHeader(a,t,i),this.renderPhotos(a,t),this.renderReviews(a,t),this.renderDetails(a,t,e),this.renderMap(a.mapCont,t,e),!i){this.triggerConfetti();const o=u("result-screen");o&&o.scrollIntoView({behavior:"smooth",block:"start"})}},updateHistory(e,t){e.Data.lastPickedId=t.id,e.Data.history||(e.Data.history=[]),e.Data.history.includes(t.id)||e.Data.history.push(t.id)},getElements(){return{name:u("res-name"),rating:u("res-rating"),ratingCont:u("res-rating-container"),price:u("res-price"),priceCont:u("res-price-container"),cat:u("res-category"),catIcon:u("res-category-icon"),catCont:u("res-category-container"),hours:u("res-hours"),hoursCont:u("res-hours-container"),address:u("res-address"),mapCont:u("res-map-container"),phone:u("res-phone"),distance:u("res-distance"),distanceCont:u("res-distance-container"),mapsBtn:u("open-maps-btn"),photoCont:u("res-photo-container"),photoSection:u("res-photo-section"),photosViewAll:u("view-all-photos"),reviewsViewAll:u("view-all-reviews"),reviewsCont:u("res-reviews-container"),reviewsList:u("reviews-list")}},renderHeader(e,t,r){e.name&&(e.name.textContent=t.name),e.address&&(e.address.textContent=t.vicinity),e.reviewsViewAll&&(e.reviewsViewAll.href=t.reviewsUri||t.googleMapsUri||"#"),e.photosViewAll&&(e.photosViewAll.href=t.photosUri||t.googleMapsUri||"#")},renderPhotos(e,t){if(e.photoSection)if(t.photos&&t.photos.length>0){if(e.photoSection.classList.remove("hidden"),e.photoCont){e.photoCont.innerHTML="";const r=document.createDocumentFragment();t.photos.forEach(i=>{const a=this.createPhotoItem(i,t.name);r.appendChild(a)}),e.photoCont.appendChild(r)}}else e.photoSection.classList.add("hidden")},createPhotoItem(e,t){const r=document.createElement("img");return r.src=e.getURI({maxHeight:400}),r.className="photo-item",r.alt=t,r.loading="lazy",r.style.opacity="0",r.style.transition="opacity 0.3s ease",r.onload=()=>{r.style.opacity="1"},r.onclick=i=>{i.preventDefault(),i.stopPropagation();const a=Array.from(r.parentElement.children).indexOf(r);this.openPhotoModal(a)},r.onerror=function(){this.getAttribute("data-retried")?this.style.display="none":(this.setAttribute("data-retried","true"),setTimeout(()=>{const i=this.src.includes("?")?"&":"?";this.src=this.src+i+"retry="+Date.now()},1e3))},r},renderReviews(e,t){if(!(!e.reviewsCont||!e.reviewsList))if(t.reviews&&t.reviews.length>0){e.reviewsCont.classList.remove("hidden"),e.reviewsList.innerHTML="",e.reviewsList.scrollLeft=0;const r=t.reviews.filter(i=>i.text&&(i.text.text||i.text).length>0).sort((i,a)=>{const o=i.publishTime?new Date(i.publishTime).getTime():0;return(a.publishTime?new Date(a.publishTime).getTime():0)-o});if(r.length===0)e.reviewsCont.classList.add("hidden");else{const i=document.createDocumentFragment();r.forEach(a=>{const o=this.createReviewItem(a);i.appendChild(o)}),e.reviewsList.appendChild(i)}}else e.reviewsCont.classList.add("hidden")},createReviewItem(e){const t=document.createElement("div");t.className="review-item";const r="â­".repeat(Math.round(e.rating||0)),i=e.relativePublishTimeDescription||"",a=document.createElement("div");a.className="review-top";const o=document.createElement("span");o.className="review-author",o.textContent=e.authorAttribution?.displayName||"Anonymous";const l=document.createElement("span");l.className="review-time",l.textContent=i,a.appendChild(o),a.appendChild(l);const d=document.createElement("div");d.className="review-stars",d.textContent=r;const c=document.createElement("p");return c.className="review-text",c.textContent=e.text?.text||e.text||"",t.appendChild(a),t.appendChild(d),t.appendChild(c),t},renderDetails(e,t,r){const i=r.translations[r.currentLang],a=typeof t.rating=="number"&&t.rating>0;e.rating&&(e.rating.textContent=a?t.rating:i.ratingNew.replace(/â­\s*/,""));const o=this.getPriceDisplay(t.priceLevel,i);e.price&&(e.price.textContent=o),e.priceCont&&(e.priceCont.style.display=o?"flex":"none");const l=this.getPlaceCategory(t,r);if(l){const c=l.match(new RegExp("^(\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F)\\s*(.*)$","u"));e.catIcon&&(e.catIcon.textContent=c?c[1]:"ðŸ´"),e.cat&&(e.cat.textContent=c?c[2]:l),e.catCont&&(e.catCont.style.display="flex")}else e.catCont&&(e.catCont.style.display="none");const d=this.getTodayHours(t,r);e.hours&&(e.hours.textContent=d),e.hoursCont&&(e.hoursCont.style.display="flex"),t.durationText?(e.distance&&(e.distance.textContent=t.durationText),e.distanceCont&&(e.distanceCont.style.display="flex")):e.distanceCont&&(e.distanceCont.style.display="none"),t.phone?e.phone&&(e.phone.textContent=`ðŸ“ž ${t.phone}`,e.phone.href=`tel:${t.phone.replace(/\s+/g,"")}`,e.phone.style.display=""):e.phone&&(e.phone.style.display="none"),e.mapsBtn&&(e.mapsBtn.href=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(t.name)}&query_place_id=${t.id}`)},async renderMap(e,t,r){if(e){if(!t.location){e.style.display="none";return}e.classList.add("skeleton"),e.style.display="block";try{const[{Map:i},{AdvancedMarkerElement:a}]=await Promise.all([google.maps.importLibrary("maps"),google.maps.importLibrary("marker")]),o=new i(e,{center:t.location,zoom:16,mapId:"DEMO_MAP_ID",disableDefaultUI:!1,mapTypeControl:!1,streetViewControl:!1,gestureHandling:"greedy",colorScheme:"FOLLOW_SYSTEM"});new a({map:o,position:t.location,title:t.name}),r.Data.userPos&&this.renderUserLocationOnMap(o,r.Data.userPos,t.location,a);const l=this.createMapCenterControl(o,t.location,r.Data.userPos);o.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(l),google.maps.event.addListenerOnce(o,"idle",()=>e.classList.remove("skeleton"))}catch(i){console.error("Map Render Error:",i),e.style.display="none"}}},openPhotoModal(e){const t=this.App||window.App;if(!t?.Data?.currentPlace?.photos){console.error("Photo Modal Error: No photos found in current place data.");return}this.currentPhotoIndex=e;const r=u("photo-modal"),i=u("modal-img"),a=t.Data.currentPlace.photos,o=a[e];if(!o)return;i.src=typeof o.getURI=="function"?o.getURI({maxHeight:1200}):o.cachedURI||"",r.classList.remove("hidden"),document.body.style.overflow="hidden";const l=a.length>1;u("modal-prev").style.display=l?"block":"none",u("modal-next").style.display=l?"block":"none"},closePhotoModal(){const e=u("photo-modal");e&&e.classList.add("hidden"),document.body.style.overflow=""},navigatePhoto(e){const t=this.App?.Data?.currentPlace?.photos;if(!t||t.length<=1)return;this.currentPhotoIndex=(this.currentPhotoIndex+e+t.length)%t.length;const r=u("modal-img"),i=t[this.currentPhotoIndex];r.style.opacity="0.5",r.src=i.getURI({maxHeight:1e3}),r.onload=()=>{r.style.opacity="1"}},initPhotoModal(e){this.App=e;const t=u("modal-prev"),r=u("modal-next"),i=u("modal-img"),a=document.querySelector(".modal-overlay");i&&(i.onclick=()=>this.closePhotoModal(),i.style.cursor="zoom-out"),a&&(a.onclick=()=>this.closePhotoModal()),t&&(t.onclick=o=>{o.stopPropagation(),this.navigatePhoto(-1)}),r&&(r.onclick=o=>{o.stopPropagation(),this.navigatePhoto(1)}),window.addEventListener("keydown",o=>{const l=u("photo-modal");l&&!l.classList.contains("hidden")&&(o.key==="Escape"&&this.closePhotoModal(),o.key==="ArrowLeft"&&this.navigatePhoto(-1),o.key==="ArrowRight"&&this.navigatePhoto(1))})},renderUserLocationOnMap(e,t,r,i){const a=document.createElement("div");a.style.width="16px",a.style.height="16px",a.style.backgroundColor="#4285F4",a.style.border="2px solid white",a.style.borderRadius="50%",a.style.boxShadow="0 0 4px rgba(0,0,0,0.3)",new i({map:e,position:t,title:"Your Location",content:a});const o=new google.maps.LatLngBounds;o.extend(r),o.extend(t),e.fitBounds(o,50)},createMapCenterControl(e,t,r){const i=document.createElement("button");return i.className="map-center-btn",i.innerHTML='<svg viewBox="0 0 24 24" width="22" height="22" fill="#666"><path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/></svg>',i.title="Re-center Map",i.onclick=()=>{if(r){const a=new google.maps.LatLngBounds;a.extend(t),a.extend(r),e.fitBounds(a,50)}else e.setCenter(t),e.setZoom(16)},i},startSlotAnimation(e){const t=u("slot-name");if(!t)return;let r=0;const i=setInterval(()=>{const a=e.Data.candidates[Math.floor(Math.random()*e.Data.candidates.length)];t.textContent=a?.name||"...",++r>15&&(clearInterval(i),he(e))},100)},getPlaceCategory(e,t){const r=t.translations[t.currentLang].categories;for(const[i,a]of Object.entries(W))if(re(e,a))return r[i];return null},getPriceDisplay(e,t){if(e==null)return"";let r=e;q[r]&&(r=q[r]);const i=oe[r];return i?i.label(t):""},getTodayHours(e,t){const r=t.translations[t.currentLang],i=e.openingHours?.weekdayDescriptions;if(!i||i.length!==7)return r.noHoursInfo;const a=new Date,o=a.toLocaleDateString(t.currentLang==="en"?"en-US":t.currentLang==="ja"?"ja-JP":"zh-HK",{weekday:"long"}),l=a.toLocaleDateString("en-US",{weekday:"long"}),d=i.find(c=>c.includes(o)||c.includes(l))||i[(a.getDay()+6)%7];if(d){const c=d.split(/: |ï¼š/);return c[1]?c[1].trim():d}return r.noHoursInfo},triggerHaptic(e){navigator.vibrate&&navigator.vibrate(e||B.HAPTIC_FEEDBACK_DURATION.SHORT)},triggerConfetti(){($.create?$.create():$)({particleCount:150,spread:70,origin:{y:.6},colors:["#ff6b81","#ffd32a","#2ecc71","#3498db"]})},async shareCurrentPlace(e){const t=e.Data.currentPlace;if(!t)return;const r=e.translations[e.currentLang],i=`${window.location.origin}${window.location.pathname}?resId=${t.id}${e.Data.userPos?`&lat=${e.Data.userPos.lat}&lng=${e.Data.userPos.lng}`:""}`,a=r.shareText.replace("${name}",t.name);if(navigator.share)try{await navigator.share({title:t.name,text:a,url:i})}catch(o){console.error("Share failed:",o)}else try{await navigator.clipboard.writeText(`${a}
${i}`),alert(r.linkCopied)}catch{alert(i)}}},Ke="modulepreload",Je=function(e){return"/"+e},ae={},Ze=function(t,r,i){let a=Promise.resolve();if(r&&r.length>0){let C=function(p){return Promise.all(p.map(g=>Promise.resolve(g).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};var l=C;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),c=d?.nonce||d?.getAttribute("nonce");a=C(r.map(p=>{if(p=Je(p),p in ae)return;ae[p]=!0;const g=p.endsWith(".css"),E=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${E}`))return;const k=document.createElement("link");if(k.rel=g?"stylesheet":Ke,g||(k.as="script"),k.crossOrigin="",k.href=p,c&&k.setAttribute("nonce",c),document.head.appendChild(k),g)return new Promise((z,F)=>{k.addEventListener("load",z),k.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(d){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=d,window.dispatchEvent(c),!c.defaultPrevented)throw d}return a.then(d=>{for(const c of d||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})};function Xe(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:i,onRegistered:a,onRegisteredSW:o,onRegisterError:l}=e;let d,c;const C=async(g=!0)=>{await c};async function p(){if("serviceWorker"in navigator){if(d=await Ze(async()=>{const{Workbox:g}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:g}},[]).then(({Workbox:g})=>new g("/sw.js",{scope:"/",type:"classic"})).catch(g=>{l?.(g)}),!d)return;d.addEventListener("activated",g=>{(g.isUpdate||g.isExternal)&&window.location.reload()}),d.addEventListener("installed",g=>{g.isUpdate||i?.()}),d.register({immediate:t}).then(g=>{o?o("/sw.js",g):a?.(g)}).catch(g=>{l?.(g)})}}return c=p(),C}const Ye={deferredPrompt:null,translations:null,currentLang:null,init(e,t){this.translations=e,this.currentLang=t,"serviceWorker"in navigator&&Xe({immediate:!0,onNeedRefresh(){console.log("New content available, will update on next launch.")},onOfflineReady(){console.log("App ready to work offline")}}),window.addEventListener("beforeinstallprompt",i=>{i.preventDefault(),this.deferredPrompt=i,u("install-container")&&!this.isIOS()&&u("install-container").classList.remove("hidden")}),window.addEventListener("appinstalled",()=>{this.deferredPrompt=null,u("install-container")&&u("install-container").classList.add("hidden")});const r=u("install-btn");r&&(r.addEventListener("click",()=>this.handleInstall()),this.isIOS()&&!this.isStandalone()&&(u("install-container").classList.remove("hidden"),r.innerHTML=`<span>${this.translations[this.currentLang].iosInstallText}</span>`,r.classList.add("ios-guide")))},isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1},isStandalone(){return window.navigator.standalone||window.matchMedia("(display-mode: standalone)").matches},async handleInstall(){if(this.isIOS()){this.translations&&this.currentLang&&alert(this.translations[this.currentLang].iosInstallAlert);return}if(!this.deferredPrompt)return;this.deferredPrompt.prompt();const{outcome:e}=await this.deferredPrompt.userChoice;this.deferredPrompt=null,u("install-container")&&u("install-container").classList.add("hidden")}},T={Config:{mins:parseInt(localStorage.getItem("currentMins")||B.DEFAULT_MINS.toString()),includeClosed:localStorage.getItem("includeClosed")==="true",get radius(){return this.mins*B.DEFAULT_SEARCH_RADIUS_MULTIPLIER},blacklist:new Set(JSON.parse(localStorage.getItem("blacklist")||localStorage.getItem("excludedTypes")||"[]")),whitelist:new Set(JSON.parse(localStorage.getItem("whitelist")||"[]")),get excluded(){return this.filterMode==="whitelist"?this.whitelist:this.blacklist},filterMode:localStorage.getItem("filterMode")||"blacklist",prices:new Set(JSON.parse(localStorage.getItem("selectedPrices")||'["1","2","3","4"]')),lang:(function(){let t=new URLSearchParams(window.location.search).get("lang")||localStorage.getItem("preferredLang");if(t&&(t.startsWith("zh")&&(t="zh"),t.startsWith("ja")&&(t="ja"),["zh","en","ja"].includes(t)))return t;const r=navigator.language||navigator.userLanguage;return r.startsWith("ja")?"ja":r.startsWith("zh")?"zh":"en"})()},Data:{userPos:null,manualLocation:null,candidates:[],currentPlace:null,lastPickedId:null,history:[],params:new URLSearchParams(window.location.search)},UI:Ge,PWA:Ye,translations:Ue,get currentLang(){return this.Config.lang},saveSettings(){localStorage.setItem("currentMins",this.Config.mins.toString()),localStorage.setItem("includeClosed",this.Config.includeClosed),localStorage.setItem("selectedPrices",JSON.stringify(Array.from(this.Config.prices))),localStorage.setItem("blacklist",JSON.stringify(Array.from(this.Config.blacklist))),localStorage.setItem("whitelist",JSON.stringify(Array.from(this.Config.whitelist))),localStorage.setItem("filterMode",this.Config.filterMode)},setLanguage(e){if(this.currentLang===e)return;localStorage.setItem("preferredLang",e),this.saveSettings();let t=window.location.pathname+"?lang="+e;!u("result-screen").classList.contains("hidden")&&this.Data.lastPickedId&&(t+="&resId="+this.Data.lastPickedId,this.Data.userPos&&(t+=`&lat=${this.Data.userPos.lat}&lng=${this.Data.userPos.lng}`)),window.location.href=t},init(){qe(),this.UI.updateStrings(this),this.UI.initFilters(this),this.setupEventListeners(),this.PWA.init(this.translations,this.currentLang),$e(this),this.UI.initPhotoModal(this),this.initLocationSearch()},async initLocationSearch(){const e=u("location-input"),t=u("location-bar"),r=u("location-display"),i=u("clear-location");if(!e||!t||!r||!i)return;const a=this.translations[this.currentLang];r.textContent=a.useCurrentLocation,t.onclick=l=>{l.target.closest(".clear-icon")||(t.classList.add("hidden"),e.classList.remove("hidden"),e.focus())};const o=()=>{setTimeout(()=>{e.classList.add("hidden"),t.classList.remove("hidden")},200)};e.onblur=o,i.onclick=l=>{l.stopPropagation(),this.Data.manualLocation=null,e.value="",r.textContent=a.useCurrentLocation,i.classList.add("hidden"),this.UI.triggerHaptic(30)};try{const{Autocomplete:l}=await google.maps.importLibrary("places"),d=new l(e,{fields:["geometry","name"],types:["geocode","establishment"]});d.addListener("place_changed",()=>{const c=d.getPlace();!c.geometry||!c.geometry.location||(this.Data.manualLocation={lat:c.geometry.location.lat(),lng:c.geometry.location.lng(),name:c.name},r.textContent="ðŸ“ "+c.name,i.classList.remove("hidden"),e.value=c.name,o(),this.UI.triggerHaptic(50))})}catch{}},setupEventListeners(){const e=u("find-btn");e&&(e.onclick=()=>se(this));const t=u("retry-btn");t&&(t.onclick=()=>he(this));const r=u("share-btn");r&&(r.onclick=()=>this.UI.shareCurrentPlace(this));const i=u("back-btn");i&&(i.onclick=()=>this.UI.showScreen("main-flow")),document.querySelectorAll(".lang-selector span").forEach(d=>{d.onclick=()=>this.setLanguage(d.dataset.lang)});const a=u("distance-slider");a&&(a.value=this.Config.mins,a.oninput=function(){const d=parseInt(this.value);T.Config.mins=d,u("distance-val").textContent=d,T.saveSettings(),T.UI.triggerHaptic(10)});const o=u("include-closed-btn");o&&(o.onclick=()=>{T.Config.includeClosed=!T.Config.includeClosed,T.saveSettings(),T.UI.updateStrings(T),T.UI.triggerHaptic(B.HAPTIC_FEEDBACK_DURATION.SHORT)});const l=u("filter-mode-toggle");l&&(l.onclick=()=>{T.Config.filterMode=T.Config.filterMode==="blacklist"?"whitelist":"blacklist",T.saveSettings(),T.UI.updateStrings(T),T.UI.initFilters(T),T.UI.triggerHaptic(B.HAPTIC_FEEDBACK_DURATION.SHORT)})}};window.App=T;document.addEventListener("DOMContentLoaded",()=>{T.init()});
